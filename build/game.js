/**
 * @link https://couchfriends.com
 * @license MIT
 */

!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Matter=e()}}(function(){return function r(s,a,l){function c(t,e){if(!a[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(d)return d(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var i=a[t]={exports:{}};s[t][0].call(i.exports,function(e){return c(s[t][1][e]||e)},i,i.exports,r,s,a,l)}return a[t].exports}for(var d="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,n){var c={};t.exports=c;var d=e("../geometry/Vertices"),u=e("../geometry/Vector"),i=e("../core/Sleeping"),r=(e("../render/Render"),e("../core/Common")),p=e("../geometry/Bounds"),m=e("../geometry/Axes");!function(){c._inertiaScale=4,c._nextCollidingGroupId=1,c._nextNonCollidingGroupId=-1,c._nextCategory=1,c.create=function(e){var t={id:r.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:d.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},n=r.extend(t,e);return o(n,e),n},c.nextGroup=function(e){return e?c._nextNonCollidingGroupId--:c._nextCollidingGroupId++},c.nextCategory=function(){return c._nextCategory=c._nextCategory<<1,c._nextCategory};var o=function(e,t){t=t||{},c.set(e,{bounds:e.bounds||p.create(e.vertices),positionPrev:e.positionPrev||u.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),d.rotate(e.vertices,e.angle,e.position),m.rotate(e.axes,e.angle),p.update(e.bounds,e.vertices,e.velocity),c.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var n=e.isStatic?"#2e2b44":r.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]);e.render.fillStyle=e.render.fillStyle||n,e.render.strokeStyle=e.render.strokeStyle||"#000",e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};c.set=function(e,t,n){var o;for(o in"string"==typeof t&&(o=t,(t={})[o]=n),t)if(n=t[o],t.hasOwnProperty(o))switch(o){case"isStatic":c.setStatic(e,n);break;case"isSleeping":i.set(e,n);break;case"mass":c.setMass(e,n);break;case"density":c.setDensity(e,n);break;case"inertia":c.setInertia(e,n);break;case"vertices":c.setVertices(e,n);break;case"position":c.setPosition(e,n);break;case"angle":c.setAngle(e,n);break;case"velocity":c.setVelocity(e,n);break;case"angularVelocity":c.setAngularVelocity(e,n);break;case"parts":c.setParts(e,n);break;default:e[o]=n}},c.setStatic=function(e,t){for(var n=0;n<e.parts.length;n++){var o=e.parts[n];(o.isStatic=t)?(o._original={restitution:o.restitution,friction:o.friction,mass:o.mass,inertia:o.inertia,density:o.density,inverseMass:o.inverseMass,inverseInertia:o.inverseInertia},o.restitution=0,o.friction=1,o.mass=o.inertia=o.density=1/0,o.inverseMass=o.inverseInertia=0,o.positionPrev.x=o.position.x,o.positionPrev.y=o.position.y,o.anglePrev=o.angle,o.angularVelocity=0,o.speed=0,o.angularSpeed=0,o.motion=0):o._original&&(o.restitution=o._original.restitution,o.friction=o._original.friction,o.mass=o._original.mass,o.inertia=o._original.inertia,o.density=o._original.density,o.inverseMass=o._original.inverseMass,o.inverseInertia=o._original.inverseInertia,delete o._original)}},c.setMass=function(e,t){var n=e.inertia/(e.mass/6);e.inertia=n*(t/6),e.inverseInertia=1/e.inertia,e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},c.setDensity=function(e,t){c.setMass(e,t*e.area),e.density=t},c.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},c.setVertices=function(e,t){t[0].body===e?e.vertices=t:e.vertices=d.create(t,e),e.axes=m.fromVertices(e.vertices),e.area=d.area(e.vertices),c.setMass(e,e.density*e.area);var n=d.centre(e.vertices);d.translate(e.vertices,n,-1),c.setInertia(e,c._inertiaScale*d.inertia(e.vertices,e.mass)),d.translate(e.vertices,e.position),p.update(e.bounds,e.vertices,e.velocity)},c.setParts=function(e,t,n){var o;for(t=t.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,o=0;o<t.length;o++){var i=t[o];i!==e&&(i.parent=e).parts.push(i)}if(1!==e.parts.length){if(n=void 0===n||n){var r=[];for(o=0;o<t.length;o++)r=r.concat(t[o].vertices);d.clockwiseSort(r);var s=d.hull(r),a=d.centre(s);c.setVertices(e,s),d.translate(e.vertices,a)}var l=c._totalProperties(e);e.area=l.area,(e.parent=e).position.x=l.centre.x,e.position.y=l.centre.y,e.positionPrev.x=l.centre.x,e.positionPrev.y=l.centre.y,c.setMass(e,l.mass),c.setInertia(e,l.inertia),c.setPosition(e,l.centre)}},c.setPosition=function(e,t){var n=u.sub(t,e.position);e.positionPrev.x+=n.x,e.positionPrev.y+=n.y;for(var o=0;o<e.parts.length;o++){var i=e.parts[o];i.position.x+=n.x,i.position.y+=n.y,d.translate(i.vertices,n),p.update(i.bounds,i.vertices,e.velocity)}},c.setAngle=function(e,t){var n=t-e.angle;e.anglePrev+=n;for(var o=0;o<e.parts.length;o++){var i=e.parts[o];i.angle+=n,d.rotate(i.vertices,n,e.position),m.rotate(i.axes,n),p.update(i.bounds,i.vertices,e.velocity),0<o&&u.rotateAbout(i.position,n,e.position,i.position)}},c.setVelocity=function(e,t){e.positionPrev.x=e.position.x-t.x,e.positionPrev.y=e.position.y-t.y,e.velocity.x=t.x,e.velocity.y=t.y,e.speed=u.magnitude(e.velocity)},c.setAngularVelocity=function(e,t){e.anglePrev=e.angle-t,e.angularVelocity=t,e.angularSpeed=Math.abs(e.angularVelocity)},c.translate=function(e,t){c.setPosition(e,u.add(e.position,t))},c.rotate=function(e,t,n){if(n){var o=Math.cos(t),i=Math.sin(t),r=e.position.x-n.x,s=e.position.y-n.y;c.setPosition(e,{x:n.x+(r*o-s*i),y:n.y+(r*i+s*o)}),c.setAngle(e,e.angle+t)}else c.setAngle(e,e.angle+t)},c.scale=function(e,t,n,o){var i=0,r=0;o=o||e.position;for(var s=0;s<e.parts.length;s++){var a=e.parts[s];d.scale(a.vertices,t,n,o),a.axes=m.fromVertices(a.vertices),a.area=d.area(a.vertices),c.setMass(a,e.density*a.area),d.translate(a.vertices,{x:-a.position.x,y:-a.position.y}),c.setInertia(a,c._inertiaScale*d.inertia(a.vertices,a.mass)),d.translate(a.vertices,{x:a.position.x,y:a.position.y}),0<s&&(i+=a.area,r+=a.inertia),a.position.x=o.x+(a.position.x-o.x)*t,a.position.y=o.y+(a.position.y-o.y)*n,p.update(a.bounds,a.vertices,e.velocity)}1<e.parts.length&&(e.area=i,e.isStatic||(c.setMass(e,e.density*i),c.setInertia(e,r))),e.circleRadius&&(t===n?e.circleRadius*=t:e.circleRadius=null)},c.update=function(e,t,n,o){var i=Math.pow(t*n*e.timeScale,2),r=1-e.frictionAir*n*e.timeScale,s=e.position.x-e.positionPrev.x,a=e.position.y-e.positionPrev.y;e.velocity.x=s*r*o+e.force.x/e.mass*i,e.velocity.y=a*r*o+e.force.y/e.mass*i,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*r*o+e.torque/e.inertia*i,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=u.magnitude(e.velocity),e.angularSpeed=Math.abs(e.angularVelocity);for(var l=0;l<e.parts.length;l++){var c=e.parts[l];d.translate(c.vertices,e.velocity),0<l&&(c.position.x+=e.velocity.x,c.position.y+=e.velocity.y),0!==e.angularVelocity&&(d.rotate(c.vertices,e.angularVelocity,e.position),m.rotate(c.axes,e.angularVelocity),0<l&&u.rotateAbout(c.position,e.angularVelocity,e.position,c.position)),p.update(c.bounds,c.vertices,e.velocity)}},c.applyForce=function(e,t,n){e.force.x+=n.x,e.force.y+=n.y;var o=t.x-e.position.x,i=t.y-e.position.y;e.torque+=o*n.y-i*n.x},c._totalProperties=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},n=1===e.parts.length?0:1;n<e.parts.length;n++){var o=e.parts[n],i=o.mass!==1/0?o.mass:1;t.mass+=i,t.area+=o.area,t.inertia+=o.inertia,t.centre=u.add(t.centre,u.mult(o.position,i))}return t.centre=u.div(t.centre,t.mass),t}}()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(e,t,n){var u={};t.exports=u;var s=e("../core/Events"),r=e("../core/Common"),a=e("../geometry/Bounds"),p=e("./Body");u.create=function(e){return r.extend({id:r.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},e)},u.setModified=function(e,t,n,o){if(e.isModified=t,n&&e.parent&&u.setModified(e.parent,t,n,o),o)for(var i=0;i<e.composites.length;i++){var r=e.composites[i];u.setModified(r,t,n,o)}},u.add=function(e,t){var n=[].concat(t);s.trigger(e,"beforeAdd",{object:t});for(var o=0;o<n.length;o++){var i=n[o];switch(i.type){case"body":if(i.parent!==i){r.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}u.addBody(e,i);break;case"constraint":u.addConstraint(e,i);break;case"composite":u.addComposite(e,i);break;case"mouseConstraint":u.addConstraint(e,i.constraint)}}return s.trigger(e,"afterAdd",{object:t}),e},u.remove=function(e,t,n){var o=[].concat(t);s.trigger(e,"beforeRemove",{object:t});for(var i=0;i<o.length;i++){var r=o[i];switch(r.type){case"body":u.removeBody(e,r,n);break;case"constraint":u.removeConstraint(e,r,n);break;case"composite":u.removeComposite(e,r,n);break;case"mouseConstraint":u.removeConstraint(e,r.constraint)}}return s.trigger(e,"afterRemove",{object:t}),e},u.addComposite=function(e,t){return e.composites.push(t),t.parent=e,u.setModified(e,!0,!0,!1),e},u.removeComposite=function(e,t,n){var o=r.indexOf(e.composites,t);if(-1!==o&&(u.removeCompositeAt(e,o),u.setModified(e,!0,!0,!1)),n)for(var i=0;i<e.composites.length;i++)u.removeComposite(e.composites[i],t,!0);return e},u.removeCompositeAt=function(e,t){return e.composites.splice(t,1),u.setModified(e,!0,!0,!1),e},u.addBody=function(e,t){return e.bodies.push(t),u.setModified(e,!0,!0,!1),e},u.removeBody=function(e,t,n){var o=r.indexOf(e.bodies,t);if(-1!==o&&(u.removeBodyAt(e,o),u.setModified(e,!0,!0,!1)),n)for(var i=0;i<e.composites.length;i++)u.removeBody(e.composites[i],t,!0);return e},u.removeBodyAt=function(e,t){return e.bodies.splice(t,1),u.setModified(e,!0,!0,!1),e},u.addConstraint=function(e,t){return e.constraints.push(t),u.setModified(e,!0,!0,!1),e},u.removeConstraint=function(e,t,n){var o=r.indexOf(e.constraints,t);if(-1!==o&&u.removeConstraintAt(e,o),n)for(var i=0;i<e.composites.length;i++)u.removeConstraint(e.composites[i],t,!0);return e},u.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),u.setModified(e,!0,!0,!1),e},u.clear=function(e,t,n){if(n)for(var o=0;o<e.composites.length;o++)u.clear(e.composites[o],t,!0);return t?e.bodies=e.bodies.filter(function(e){return e.isStatic}):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,u.setModified(e,!0,!0,!1),e},u.allBodies=function(e){for(var t=[].concat(e.bodies),n=0;n<e.composites.length;n++)t=t.concat(u.allBodies(e.composites[n]));return t},u.allConstraints=function(e){for(var t=[].concat(e.constraints),n=0;n<e.composites.length;n++)t=t.concat(u.allConstraints(e.composites[n]));return t},u.allComposites=function(e){for(var t=[].concat(e.composites),n=0;n<e.composites.length;n++)t=t.concat(u.allComposites(e.composites[n]));return t},u.get=function(e,t,n){var o,i;switch(n){case"body":o=u.allBodies(e);break;case"constraint":o=u.allConstraints(e);break;case"composite":o=u.allComposites(e).concat(e)}return o?0===(i=o.filter(function(e){return e.id.toString()===t.toString()})).length?null:i[0]:null},u.move=function(e,t,n){return u.remove(e,t),u.add(n,t),e},u.rebase=function(e){for(var t=u.allBodies(e).concat(u.allConstraints(e)).concat(u.allComposites(e)),n=0;n<t.length;n++)t[n].id=r.nextId();return u.setModified(e,!0,!0,!1),e},u.translate=function(e,t,n){for(var o=n?u.allBodies(e):e.bodies,i=0;i<o.length;i++)p.translate(o[i],t);return u.setModified(e,!0,!0,!1),e},u.rotate=function(e,t,n,o){for(var i=Math.cos(t),r=Math.sin(t),s=o?u.allBodies(e):e.bodies,a=0;a<s.length;a++){var l=s[a],c=l.position.x-n.x,d=l.position.y-n.y;p.setPosition(l,{x:n.x+(c*i-d*r),y:n.y+(c*r+d*i)}),p.rotate(l,t)}return u.setModified(e,!0,!0,!1),e},u.scale=function(e,t,n,o,i){for(var r=i?u.allBodies(e):e.bodies,s=0;s<r.length;s++){var a=r[s],l=a.position.x-o.x,c=a.position.y-o.y;p.setPosition(a,{x:o.x+l*t,y:o.y+c*n}),p.scale(a,t,n)}return u.setModified(e,!0,!0,!1),e},u.bounds=function(e){for(var t=u.allBodies(e),n=[],o=0;o<t.length;o+=1){var i=t[o];n.push(i.bounds.min,i.bounds.max)}return a.create(n)}},{"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"./Body":1}],3:[function(e,t,n){var o={};t.exports=o;var i=e("./Composite"),r=(e("../constraint/Constraint"),e("../core/Common"));o.create=function(e){var t=i.create(),n={label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-1/0,y:-1/0},max:{x:1/0,y:1/0}}};return r.extend(t,n,e)}},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(e,t,n){var o={};(t.exports=o).create=function(e){return{id:o.id(e),vertex:e,normalImpulse:0,tangentImpulse:0}},o.id=function(e){return e.body.id+"_"+e.index}},{}],5:[function(e,t,n){var f={};t.exports=f;var v=e("./SAT"),y=e("./Pair"),g=e("../geometry/Bounds");f.collisions=function(e,t){for(var n=[],o=t.pairs.table,i=0;i<e.length;i++){var r=e[i][0],s=e[i][1];if((!r.isStatic&&!r.isSleeping||!s.isStatic&&!s.isSleeping)&&f.canCollide(r.collisionFilter,s.collisionFilter)&&g.overlaps(r.bounds,s.bounds))for(var a=1<r.parts.length?1:0;a<r.parts.length;a++)for(var l=r.parts[a],c=1<s.parts.length?1:0;c<s.parts.length;c++){var d=s.parts[c];if(l===r&&d===s||g.overlaps(l.bounds,d.bounds)){var u,p=o[y.id(l,d)];u=p&&p.isActive?p.collision:null;var m=v.collides(l,d,u);m.collided&&n.push(m)}}}return n},f.canCollide=function(e,t){return e.group===t.group&&0!==e.group?0<e.group:0!=(e.mask&t.category)&&0!=(t.mask&e.category)}},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(e,t,n){var g={};t.exports=g;var a=e("./Pair"),o=e("./Detector"),l=e("../core/Common");g.create=function(e){var t={controller:g,detector:o.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return l.extend(t,e)},g.update=function(e,t,n,o){var i,r,s,a,l,c=n.world,d=e.buckets,u=!1;for(i=0;i<t.length;i++){var p=t[i];if((!p.isSleeping||o)&&!(p.bounds.max.x<c.bounds.min.x||p.bounds.min.x>c.bounds.max.x||p.bounds.max.y<c.bounds.min.y||p.bounds.min.y>c.bounds.max.y)){var m=g._getRegion(e,p);if(!p.region||m.id!==p.region.id||o){p.region&&!o||(p.region=m);var f=g._regionUnion(m,p.region);for(r=f.startCol;r<=f.endCol;r++)for(s=f.startRow;s<=f.endRow;s++){a=d[l=g._getBucketId(r,s)];var v=r>=m.startCol&&r<=m.endCol&&s>=m.startRow&&s<=m.endRow,y=r>=p.region.startCol&&r<=p.region.endCol&&s>=p.region.startRow&&s<=p.region.endRow;!v&&y&&y&&a&&g._bucketRemoveBody(e,a,p),(p.region===m||v&&!y||o)&&(a||(a=g._createBucket(d,l)),g._bucketAddBody(e,a,p))}p.region=m,u=!0}}}u&&(e.pairsList=g._createActivePairsList(e))},g.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]},g._regionUnion=function(e,t){var n=Math.min(e.startCol,t.startCol),o=Math.max(e.endCol,t.endCol),i=Math.min(e.startRow,t.startRow),r=Math.max(e.endRow,t.endRow);return g._createRegion(n,o,i,r)},g._getRegion=function(e,t){var n=t.bounds,o=Math.floor(n.min.x/e.bucketWidth),i=Math.floor(n.max.x/e.bucketWidth),r=Math.floor(n.min.y/e.bucketHeight),s=Math.floor(n.max.y/e.bucketHeight);return g._createRegion(o,i,r,s)},g._createRegion=function(e,t,n,o){return{id:e+","+t+","+n+","+o,startCol:e,endCol:t,startRow:n,endRow:o}},g._getBucketId=function(e,t){return"C"+e+"R"+t},g._createBucket=function(e,t){return e[t]=[]},g._bucketAddBody=function(e,t,n){for(var o=0;o<t.length;o++){var i=t[o];if(!(n.id===i.id||n.isStatic&&i.isStatic)){var r=a.id(n,i),s=e.pairs[r];s?s[2]+=1:e.pairs[r]=[n,i,1]}}t.push(n)},g._bucketRemoveBody=function(e,t,n){t.splice(l.indexOf(t,n),1);for(var o=0;o<t.length;o++){var i=t[o],r=a.id(n,i),s=e.pairs[r];s&&(s[2]-=1)}},g._createActivePairsList=function(e){var t,n,o=[];t=l.keys(e.pairs);for(var i=0;i<t.length;i++)0<(n=e.pairs[t[i]])[2]?o.push(n):delete e.pairs[t[i]];return o}},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(e,t,n){var p={};t.exports=p;var m=e("./Contact");p.create=function(e,t){var n=e.bodyA,o=e.bodyB,i=e.parentA,r=e.parentB,s={id:p.id(n,o),bodyA:n,bodyB:o,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:n.isSensor||o.isSensor,timeCreated:t,timeUpdated:t,inverseMass:i.inverseMass+r.inverseMass,friction:Math.min(i.friction,r.friction),frictionStatic:Math.max(i.frictionStatic,r.frictionStatic),restitution:Math.max(i.restitution,r.restitution),slop:Math.max(i.slop,r.slop)};return p.update(s,e,t),s},p.update=function(e,t,n){var o=e.contacts,i=t.supports,r=e.activeContacts,s=t.parentA,a=t.parentB;if(e.collision=t,e.inverseMass=s.inverseMass+a.inverseMass,e.friction=Math.min(s.friction,a.friction),e.frictionStatic=Math.max(s.frictionStatic,a.frictionStatic),e.restitution=Math.max(s.restitution,a.restitution),e.slop=Math.max(s.slop,a.slop),r.length=0,t.collided){for(var l=0;l<i.length;l++){var c=i[l],d=m.id(c),u=o[d];u?r.push(u):r.push(o[d]=m.create(c))}e.separation=t.depth,p.setActive(e,!0,n)}else!0===e.isActive&&p.setActive(e,!1,n)},p.setActive=function(e,t,n){t?(e.isActive=!0,e.timeUpdated=n):(e.isActive=!1,e.activeContacts.length=0)},p.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}},{"./Contact":4}],8:[function(e,t,n){var c={};t.exports=c;var m=e("./Pair"),f=e("../core/Common");c._pairMaxIdleLife=1e3,c.create=function(e){return f.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},c.update=function(e,t,n){var o,i,r,s,a=e.list,l=e.table,c=e.collisionStart,d=e.collisionEnd,u=e.collisionActive,p=[];for(c.length=0,d.length=0,s=u.length=0;s<t.length;s++)(o=t[s]).collided&&(i=m.id(o.bodyA,o.bodyB),p.push(i),(r=l[i])?(r.isActive?u.push(r):c.push(r),m.update(r,o,n)):(r=m.create(o,n),l[i]=r,c.push(r),a.push(r)));for(s=0;s<a.length;s++)(r=a[s]).isActive&&-1===f.indexOf(p,r.id)&&(m.setActive(r,!1,n),d.push(r))},c.removeOld=function(e,t){var n,o,i,r,s=e.list,a=e.table,l=[];for(r=0;r<s.length;r++)(o=(n=s[r]).collision).bodyA.isSleeping||o.bodyB.isSleeping?n.timeUpdated=t:t-n.timeUpdated>c._pairMaxIdleLife&&l.push(r);for(r=0;r<l.length;r++)delete a[(n=s[i=l[r]-r]).id],s.splice(i,1)},c.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}},{"../core/Common":14,"./Pair":7}],9:[function(e,t,n){var p={};t.exports=p;var m=e("../geometry/Vector"),l=e("./SAT"),c=e("../geometry/Bounds"),f=e("../factory/Bodies"),a=e("../geometry/Vertices");p.collides=function(e,t){for(var n=[],o=0;o<t.length;o++){var i=t[o];if(c.overlaps(i.bounds,e.bounds))for(var r=1===i.parts.length?0:1;r<i.parts.length;r++){var s=i.parts[r];if(c.overlaps(s.bounds,e.bounds)){var a=l.collides(s,e);if(a.collided){n.push(a);break}}}}return n},p.ray=function(e,t,n,o){o=o||1e-100;for(var i=m.angle(t,n),r=m.magnitude(m.sub(t,n)),s=.5*(n.x+t.x),a=.5*(n.y+t.y),l=f.rectangle(s,a,r,o,{angle:i}),c=p.collides(l,e),d=0;d<c.length;d+=1){var u=c[d];u.body=u.bodyB=u.bodyA}return c},p.region=function(e,t,n){for(var o=[],i=0;i<e.length;i++){var r=e[i],s=c.overlaps(r.bounds,t);(s&&!n||!s&&n)&&o.push(r)}return o},p.point=function(e,t){for(var n=[],o=0;o<e.length;o++){var i=e[o];if(c.contains(i.bounds,t))for(var r=1===i.parts.length?0:1;r<i.parts.length;r++){var s=i.parts[r];if(c.contains(s.bounds,t)&&a.contains(s.vertices,t)){n.push(i);break}}}return n}},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(e,t,n){var W={};t.exports=W;var r=e("../geometry/Vertices"),D=e("../geometry/Vector"),N=e("../core/Common"),s=e("../geometry/Bounds");W._restingThresh=4,W._restingThreshTangent=6,W._positionDampen=.9,W._positionWarming=.8,W._frictionNormalMultiplier=5,W.preSolvePosition=function(e){var t,n,o;for(t=0;t<e.length;t++)(n=e[t]).isActive&&(o=n.activeContacts.length,n.collision.parentA.totalContacts+=o,n.collision.parentB.totalContacts+=o)},W.solvePosition=function(e,t){var n,o,i,r,s,a,l,c,d,u=D._temp[0],p=D._temp[1],m=D._temp[2],f=D._temp[3];for(n=0;n<e.length;n++)(o=e[n]).isActive&&!o.isSensor&&(r=(i=o.collision).parentA,s=i.parentB,a=i.normal,l=D.sub(D.add(s.positionImpulse,s.position,u),D.add(r.positionImpulse,D.sub(s.position,i.penetration,p),m),f),o.separation=D.dot(a,l));for(n=0;n<e.length;n++)(o=e[n]).isActive&&!o.isSensor&&(r=(i=o.collision).parentA,s=i.parentB,a=i.normal,d=(o.separation-o.slop)*t,(r.isStatic||s.isStatic)&&(d*=2),r.isStatic||r.isSleeping||(c=W._positionDampen/r.totalContacts,r.positionImpulse.x+=a.x*d*c,r.positionImpulse.y+=a.y*d*c),s.isStatic||s.isSleeping||(c=W._positionDampen/s.totalContacts,s.positionImpulse.x-=a.x*d*c,s.positionImpulse.y-=a.y*d*c))},W.postSolvePosition=function(e){for(var t=0;t<e.length;t++){var n=e[t];if((n.totalContacts=0)!==n.positionImpulse.x||0!==n.positionImpulse.y){for(var o=0;o<n.parts.length;o++){var i=n.parts[o];r.translate(i.vertices,n.positionImpulse),s.update(i.bounds,i.vertices,n.velocity),i.position.x+=n.positionImpulse.x,i.position.y+=n.positionImpulse.y}n.positionPrev.x+=n.positionImpulse.x,n.positionPrev.y+=n.positionImpulse.y,D.dot(n.positionImpulse,n.velocity)<0?(n.positionImpulse.x=0,n.positionImpulse.y=0):(n.positionImpulse.x*=W._positionWarming,n.positionImpulse.y*=W._positionWarming)}}},W.preSolveVelocity=function(e){var t,n,o,i,r,s,a,l,c,d,u,p,m,f,v=D._temp[0],y=D._temp[1];for(t=0;t<e.length;t++)if((o=e[t]).isActive&&!o.isSensor)for(i=o.activeContacts,s=(r=o.collision).parentA,a=r.parentB,l=r.normal,c=r.tangent,n=0;n<i.length;n++)u=(d=i[n]).vertex,p=d.normalImpulse,m=d.tangentImpulse,0===p&&0===m||(v.x=l.x*p+c.x*m,v.y=l.y*p+c.y*m,s.isStatic||s.isSleeping||(f=D.sub(u,s.position,y),s.positionPrev.x+=v.x*s.inverseMass,s.positionPrev.y+=v.y*s.inverseMass,s.anglePrev+=D.cross(f,v)*s.inverseInertia),a.isStatic||a.isSleeping||(f=D.sub(u,a.position,y),a.positionPrev.x-=v.x*a.inverseMass,a.positionPrev.y-=v.y*a.inverseMass,a.anglePrev-=D.cross(f,v)*a.inverseInertia))},W.solveVelocity=function(e,t){for(var n=t*t,o=D._temp[0],i=D._temp[1],r=D._temp[2],s=D._temp[3],a=D._temp[4],l=D._temp[5],c=0;c<e.length;c++){var d=e[c];if(d.isActive&&!d.isSensor){var u=d.collision,p=u.parentA,m=u.parentB,f=u.normal,v=u.tangent,y=d.activeContacts,g=1/y.length;p.velocity.x=p.position.x-p.positionPrev.x,p.velocity.y=p.position.y-p.positionPrev.y,m.velocity.x=m.position.x-m.positionPrev.x,m.velocity.y=m.position.y-m.positionPrev.y,p.angularVelocity=p.angle-p.anglePrev,m.angularVelocity=m.angle-m.anglePrev;for(var x=0;x<y.length;x++){var h=y[x],b=h.vertex,w=D.sub(b,p.position,i),S=D.sub(b,m.position,r),C=D.add(p.velocity,D.mult(D.perp(w),p.angularVelocity),s),A=D.add(m.velocity,D.mult(D.perp(S),m.angularVelocity),a),P=D.sub(C,A,l),B=D.dot(f,P),M=D.dot(v,P),k=Math.abs(M),I=N.sign(M),_=(1+d.restitution)*B,T=N.clamp(d.separation+B,0,1)*W._frictionNormalMultiplier,R=M,V=1/0;k>d.friction*d.frictionStatic*T*n&&(V=k,R=N.clamp(d.friction*I*n,-V,V));var E=D.cross(w,f),L=D.cross(S,f),F=g/(p.inverseMass+m.inverseMass+p.inverseInertia*E*E+m.inverseInertia*L*L);if(_*=F,R*=F,B<0&&B*B>W._restingThresh*n)h.normalImpulse=0;else{var O=h.normalImpulse;h.normalImpulse=Math.min(h.normalImpulse+_,0),_=h.normalImpulse-O}if(M*M>W._restingThreshTangent*n)h.tangentImpulse=0;else{var q=h.tangentImpulse;h.tangentImpulse=N.clamp(h.tangentImpulse+R,-V,V),R=h.tangentImpulse-q}o.x=f.x*_+v.x*R,o.y=f.y*_+v.y*R,p.isStatic||p.isSleeping||(p.positionPrev.x+=o.x*p.inverseMass,p.positionPrev.y+=o.y*p.inverseMass,p.anglePrev+=D.cross(w,o)*p.inverseInertia),m.isStatic||m.isSleeping||(m.positionPrev.x-=o.x*m.inverseMass,m.positionPrev.y-=o.y*m.inverseMass,m.anglePrev-=D.cross(S,o)*m.inverseInertia)}}}}},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(e,t,n){var g={};t.exports=g;var x=e("../geometry/Vertices"),h=e("../geometry/Vector");g.collides=function(e,t,n){var o,i,r,s,a=!1;if(n){var l=e.parent,c=t.parent,d=l.speed*l.speed+l.angularSpeed*l.angularSpeed+c.speed*c.speed+c.angularSpeed*c.angularSpeed;a=n&&n.collided&&d<.2,s=n}else s={collided:!1,bodyA:e,bodyB:t};if(n&&a){var u=s.axisBody,p=u===e?t:e,m=[u.axes[n.axisNumber]];if(r=g._overlapAxes(u.vertices,p.vertices,m),s.reused=!0,r.overlap<=0)return s.collided=!1,s}else{if((o=g._overlapAxes(e.vertices,t.vertices,e.axes)).overlap<=0)return s.collided=!1,s;if((i=g._overlapAxes(t.vertices,e.vertices,t.axes)).overlap<=0)return s.collided=!1,s;o.overlap<i.overlap?(r=o,s.axisBody=e):(r=i,s.axisBody=t),s.axisNumber=r.axisNumber}s.bodyA=e.id<t.id?e:t,s.bodyB=e.id<t.id?t:e,s.collided=!0,s.depth=r.overlap,s.parentA=s.bodyA.parent,s.parentB=s.bodyB.parent,e=s.bodyA,t=s.bodyB,h.dot(r.axis,h.sub(t.position,e.position))<0?s.normal={x:r.axis.x,y:r.axis.y}:s.normal={x:-r.axis.x,y:-r.axis.y},s.tangent=h.perp(s.normal),s.penetration=s.penetration||{},s.penetration.x=s.normal.x*s.depth,s.penetration.y=s.normal.y*s.depth;var f=g._findSupports(e,t,s.normal),v=[];if(x.contains(e.vertices,f[0])&&v.push(f[0]),x.contains(e.vertices,f[1])&&v.push(f[1]),v.length<2){var y=g._findSupports(t,e,h.neg(s.normal));x.contains(t.vertices,y[0])&&v.push(y[0]),v.length<2&&x.contains(t.vertices,y[1])&&v.push(y[1])}return v.length<1&&(v=[f[0]]),s.supports=v,s},g._overlapAxes=function(e,t,n){for(var o,i,r=h._temp[0],s=h._temp[1],a={overlap:Number.MAX_VALUE},l=0;l<n.length;l++){if(i=n[l],g._projectToAxis(r,e,i),g._projectToAxis(s,t,i),(o=Math.min(r.max-s.min,s.max-r.min))<=0)return a.overlap=o,a;o<a.overlap&&(a.overlap=o,a.axis=i,a.axisNumber=l)}return a},g._projectToAxis=function(e,t,n){for(var o=h.dot(t[0],n),i=o,r=1;r<t.length;r+=1){var s=h.dot(t[r],n);i<s?i=s:s<o&&(o=s)}e.min=o,e.max=i},g._findSupports=function(e,t,n){for(var o,i,r,s,a=Number.MAX_VALUE,l=h._temp[0],c=t.vertices,d=e.position,u=0;u<c.length;u++)i=c[u],l.x=i.x-d.x,l.y=i.y-d.y,(o=-h.dot(n,l))<a&&(a=o,r=i);return i=c[0<=r.index-1?r.index-1:c.length-1],l.x=i.x-d.x,l.y=i.y-d.y,a=-h.dot(n,l),s=i,i=c[(r.index+1)%c.length],l.x=i.x-d.x,l.y=i.y-d.y,(o=-h.dot(n,l))<a&&(s=i),[r,s]}},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(e,t,n){var w={};t.exports=w;var s=e("../geometry/Vertices"),S=e("../geometry/Vector"),a=e("../core/Sleeping"),l=e("../geometry/Bounds"),c=e("../geometry/Axes"),d=e("../core/Common");w._warming=.4,w._torqueDampen=1,w._minLength=1e-6,w.create=function(e){var t=e;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var n=t.bodyA?S.add(t.bodyA.position,t.pointA):t.pointA,o=t.bodyB?S.add(t.bodyB.position,t.pointB):t.pointB,i=S.magnitude(S.sub(n,o));t.length=void 0!==t.length?t.length:i,t.id=t.id||d.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(0<t.length?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var r={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===t.length&&.1<t.stiffness?(r.type="pin",r.anchors=!1):t.stiffness<.9&&(r.type="spring"),t.render=d.extend(r,t.render),t},w.preSolveAll=function(e){for(var t=0;t<e.length;t+=1){var n=e[t],o=n.constraintImpulse;n.isStatic||0===o.x&&0===o.y&&0===o.angle||(n.position.x+=o.x,n.position.y+=o.y,n.angle+=o.angle)}},w.solveAll=function(e,t){for(var n=0;n<e.length;n+=1){var o=e[n],i=!o.bodyA||o.bodyA&&o.bodyA.isStatic,r=!o.bodyB||o.bodyB&&o.bodyB.isStatic;(i||r)&&w.solve(e[n],t)}for(n=0;n<e.length;n+=1)i=!(o=e[n]).bodyA||o.bodyA&&o.bodyA.isStatic,r=!o.bodyB||o.bodyB&&o.bodyB.isStatic,i||r||w.solve(e[n],t)},w.solve=function(e,t){var n=e.bodyA,o=e.bodyB,i=e.pointA,r=e.pointB;if(n||o){n&&!n.isStatic&&(S.rotate(i,n.angle-e.angleA,i),e.angleA=n.angle),o&&!o.isStatic&&(S.rotate(r,o.angle-e.angleB,r),e.angleB=o.angle);var s=i,a=r;if(n&&(s=S.add(n.position,i)),o&&(a=S.add(o.position,r)),s&&a){var l=S.sub(s,a),c=S.magnitude(l);c<w._minLength&&(c=w._minLength);var d,u,p,m,f,v=(c-e.length)/c,y=e.stiffness<1?e.stiffness*t:e.stiffness,g=S.mult(l,v*y),x=(n?n.inverseMass:0)+(o?o.inverseMass:0),h=x+((n?n.inverseInertia:0)+(o?o.inverseInertia:0));if(e.damping){var b=S.create();p=S.div(l,c),f=S.sub(o&&S.sub(o.position,o.positionPrev)||b,n&&S.sub(n.position,n.positionPrev)||b),m=S.dot(p,f)}n&&!n.isStatic&&(u=n.inverseMass/x,n.constraintImpulse.x-=g.x*u,n.constraintImpulse.y-=g.y*u,n.position.x-=g.x*u,n.position.y-=g.y*u,e.damping&&(n.positionPrev.x-=e.damping*p.x*m*u,n.positionPrev.y-=e.damping*p.y*m*u),d=S.cross(i,g)/h*w._torqueDampen*n.inverseInertia*(1-e.angularStiffness),n.constraintImpulse.angle-=d,n.angle-=d),o&&!o.isStatic&&(u=o.inverseMass/x,o.constraintImpulse.x+=g.x*u,o.constraintImpulse.y+=g.y*u,o.position.x+=g.x*u,o.position.y+=g.y*u,e.damping&&(o.positionPrev.x+=e.damping*p.x*m*u,o.positionPrev.y+=e.damping*p.y*m*u),d=S.cross(r,g)/h*w._torqueDampen*o.inverseInertia*(1-e.angularStiffness),o.constraintImpulse.angle+=d,o.angle+=d)}}},w.postSolveAll=function(e){for(var t=0;t<e.length;t++){var n=e[t],o=n.constraintImpulse;if(!(n.isStatic||0===o.x&&0===o.y&&0===o.angle)){a.set(n,!1);for(var i=0;i<n.parts.length;i++){var r=n.parts[i];s.translate(r.vertices,o),0<i&&(r.position.x+=o.x,r.position.y+=o.y),0!==o.angle&&(s.rotate(r.vertices,o.angle,n.position),c.rotate(r.axes,o.angle),0<i&&S.rotateAbout(r.position,o.angle,n.position,r.position)),l.update(r.bounds,r.vertices,n.velocity)}o.angle*=w._warming,o.x*=w._warming,o.y*=w._warming}}}},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(e,t,n){var r={};t.exports=r;var l=e("../geometry/Vertices"),c=e("../core/Sleeping"),s=e("../core/Mouse"),d=e("../core/Events"),u=e("../collision/Detector"),a=e("./Constraint"),p=e("../body/Composite"),m=e("../core/Common"),f=e("../geometry/Bounds");r.create=function(t,e){var n=(t?t.mouse:null)||(e?e.mouse:null);n||(t&&t.render&&t.render.canvas?n=s.create(t.render.canvas):e&&e.element?n=s.create(e.element):(n=s.create(),m.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var o={type:"mouseConstraint",mouse:n,element:null,body:null,constraint:a.create({label:"Mouse Constraint",pointA:n.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},i=m.extend(o,e);return d.on(t,"beforeUpdate",function(){var e=p.allBodies(t.world);r.update(i,e),r._triggerEvents(i)}),i},r.update=function(e,t){var n=e.mouse,o=e.constraint,i=e.body;if(0===n.button){if(o.bodyB)c.set(o.bodyB,!1),o.pointA=n.position;else for(var r=0;r<t.length;r++)if(i=t[r],f.contains(i.bounds,n.position)&&u.canCollide(i.collisionFilter,e.collisionFilter))for(var s=1<i.parts.length?1:0;s<i.parts.length;s++){var a=i.parts[s];if(l.contains(a.vertices,n.position)){o.pointA=n.position,o.bodyB=e.body=i,o.pointB={x:n.position.x-i.position.x,y:n.position.y-i.position.y},o.angleB=i.angle,c.set(i,!1),d.trigger(e,"startdrag",{mouse:n,body:i});break}}}else o.bodyB=e.body=null,o.pointB=null,i&&d.trigger(e,"enddrag",{mouse:n,body:i})},r._triggerEvents=function(e){var t=e.mouse,n=t.sourceEvents;n.mousemove&&d.trigger(e,"mousemove",{mouse:t}),n.mousedown&&d.trigger(e,"mousedown",{mouse:t}),n.mouseup&&d.trigger(e,"mouseup",{mouse:t}),s.clearSourceEvents(t)}},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(i,e,t){(function(o){var l={};e.exports=l,function(){l._nextId=0,l._seed=0,l._nowStartTime=+new Date,l.extend=function(e,t){var n,o;o="boolean"==typeof t?(n=2,t):(n=1,!0);for(var i=n;i<arguments.length;i++){var r=arguments[i];if(r)for(var s in r)o&&r[s]&&r[s].constructor===Object?e[s]&&e[s].constructor!==Object?e[s]=r[s]:(e[s]=e[s]||{},l.extend(e[s],o,r[s])):e[s]=r[s]}return e},l.clone=function(e,t){return l.extend({},t,e)},l.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)t.push(n);return t},l.values=function(e){var t=[];if(Object.keys){for(var n=Object.keys(e),o=0;o<n.length;o++)t.push(e[n[o]]);return t}for(var i in e)t.push(e[i]);return t},l.get=function(e,t,n,o){t=t.split(".").slice(n,o);for(var i=0;i<t.length;i+=1)e=e[t[i]];return e},l.set=function(e,t,n,o,i){var r=t.split(".").slice(o,i);return l.get(e,t,0,-1)[r[r.length-1]]=n},l.shuffle=function(e){for(var t=e.length-1;0<t;t--){var n=Math.floor(l.random()*(t+1)),o=e[t];e[t]=e[n],e[n]=o}return e},l.choose=function(e){return e[Math.floor(l.random()*e.length)]},l.isElement=function(e){return"undefined"!=typeof HTMLElement?e instanceof HTMLElement:!!(e&&e.nodeType&&e.nodeName)},l.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},l.isFunction=function(e){return"function"==typeof e},l.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},l.isString=function(e){return"[object String]"===toString.call(e)},l.clamp=function(e,t,n){return e<t?t:n<e?n:e},l.sign=function(e){return e<0?-1:1},l.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-l._nowStartTime},l.random=function(e,t){return t=void 0!==t?t:1,(e=void 0!==e?e:0)+n()*(t-e)};var n=function(){return l._seed=(9301*l._seed+49297)%233280,l._seed/233280};l.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},l.logLevel=1,l.log=function(){console&&0<l.logLevel&&l.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.info=function(){console&&0<l.logLevel&&l.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.warn=function(){console&&0<l.logLevel&&l.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.nextId=function(){return l._nextId++},l.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},l.map=function(e,t){if(e.map)return e.map(t);for(var n=[],o=0;o<e.length;o+=1)n.push(t(e[o]));return n},l.topologicalSort=function(e){var t=[],n=[],o=[];for(var i in e)n[i]||o[i]||l._topologicalSort(i,n,o,e,t);return t},l._topologicalSort=function(e,t,n,o,i){var r=o[e]||[];n[e]=!0;for(var s=0;s<r.length;s+=1){var a=r[s];n[a]||(t[a]||l._topologicalSort(a,t,n,o,i))}n[e]=!1,t[e]=!0,i.push(e)},l.chain=function(){for(var r=[],e=0;e<arguments.length;e+=1){var t=arguments[e];t._chained?r.push.apply(r,t._chained):r.push(t)}var n=function(){for(var e,t=new Array(arguments.length),n=0,o=arguments.length;n<o;n++)t[n]=arguments[n];for(n=0;n<r.length;n+=1){var i=r[n].apply(e,t);void 0!==i&&(e=i)}return e};return n._chained=r,n},l.chainPathBefore=function(e,t,n){return l.set(e,t,l.chain(n,l.get(e,t)))},l.chainPathAfter=function(e,t,n){return l.set(e,t,l.chain(l.get(e,t),n))},l._requireGlobal=function(e,t){return("undefined"!=typeof window?window[e]:void 0!==o?o[e]:null)||i(t)}}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(e,t,n){var f={};t.exports=f;var r=e("../body/World"),v=e("./Sleeping"),y=e("../collision/Resolver"),s=e("../render/Render"),g=e("../collision/Pairs"),a=(e("./Metrics"),e("../collision/Grid")),x=e("./Events"),h=e("../body/Composite"),b=e("../constraint/Constraint"),l=e("./Common"),c=e("../body/Body");f.create=function(e,t){t=(t=l.isElement(e)?t:e)||{},((e=l.isElement(e)?e:null)||t.render)&&l.warn("Engine.create: engine.render is deprecated (see docs)");var n={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:a}},o=l.extend(n,t);if(e||o.render){var i={element:e,controller:s};o.render=l.extend(i,o.render)}return o.render&&o.render.controller&&(o.render=o.render.controller.create(o.render)),o.render&&(o.render.engine=o),o.world=t.world||r.create(o.world),o.pairs=g.create(),o.broadphase=o.broadphase.controller.create(o.broadphase),o.metrics=o.metrics||{extended:!1},o},f.update=function(e,t,n){t=t||1e3/60,n=n||1;var o,i=e.world,r=e.timing,s=e.broadphase,a=[];r.timestamp+=t*r.timeScale;var l={timestamp:r.timestamp};x.trigger(e,"beforeUpdate",l);var c=h.allBodies(i),d=h.allConstraints(i);for(e.enableSleeping&&v.update(c,r.timeScale),f._bodiesApplyGravity(c,i.gravity),f._bodiesUpdate(c,t,r.timeScale,n,i.bounds),b.preSolveAll(c),o=0;o<e.constraintIterations;o++)b.solveAll(d,r.timeScale);b.postSolveAll(c),a=s.controller?(i.isModified&&s.controller.clear(s),s.controller.update(s,c,e,i.isModified),s.pairsList):c,i.isModified&&h.setModified(i,!1,!1,!0);var u=s.detector(a,e),p=e.pairs,m=r.timestamp;for(g.update(p,u,m),g.removeOld(p,m),e.enableSleeping&&v.afterCollisions(p.list,r.timeScale),0<p.collisionStart.length&&x.trigger(e,"collisionStart",{pairs:p.collisionStart}),y.preSolvePosition(p.list),o=0;o<e.positionIterations;o++)y.solvePosition(p.list,r.timeScale);for(y.postSolvePosition(c),b.preSolveAll(c),o=0;o<e.constraintIterations;o++)b.solveAll(d,r.timeScale);for(b.postSolveAll(c),y.preSolveVelocity(p.list),o=0;o<e.velocityIterations;o++)y.solveVelocity(p.list,r.timeScale);return 0<p.collisionActive.length&&x.trigger(e,"collisionActive",{pairs:p.collisionActive}),0<p.collisionEnd.length&&x.trigger(e,"collisionEnd",{pairs:p.collisionEnd}),f._bodiesClearForces(c),x.trigger(e,"afterUpdate",l),e},f.merge=function(e,t){if(l.extend(e,t),t.world){e.world=t.world,f.clear(e);for(var n=h.allBodies(e.world),o=0;o<n.length;o++){var i=n[o];v.set(i,!1),i.id=l.nextId()}}},f.clear=function(e){var t=e.world;g.clear(e.pairs);var n=e.broadphase;if(n.controller){var o=h.allBodies(t);n.controller.clear(n),n.controller.update(n,o,e,!0)}},f._bodiesClearForces=function(e){for(var t=0;t<e.length;t++){var n=e[t];n.force.x=0,n.force.y=0,n.torque=0}},f._bodiesApplyGravity=function(e,t){var n=void 0!==t.scale?t.scale:.001;if((0!==t.x||0!==t.y)&&0!==n)for(var o=0;o<e.length;o++){var i=e[o];i.isStatic||i.isSleeping||(i.force.y+=i.mass*t.y*n,i.force.x+=i.mass*t.x*n)}},f._bodiesUpdate=function(e,t,n,o,i){for(var r=0;r<e.length;r++){var s=e[r];s.isStatic||s.isSleeping||c.update(s,t,n,o)}}},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(e,t,n){var o={};t.exports=o;var c=e("./Common");o.on=function(e,t,n){for(var o,i=t.split(" "),r=0;r<i.length;r++)o=i[r],e.events=e.events||{},e.events[o]=e.events[o]||[],e.events[o].push(n);return n},o.off=function(e,t,n){if(t){"function"==typeof t&&(n=t,t=c.keys(e.events).join(" "));for(var o=t.split(" "),i=0;i<o.length;i++){var r=e.events[o[i]],s=[];if(n&&r)for(var a=0;a<r.length;a++)r[a]!==n&&s.push(r[a]);e.events[o[i]]=s}}else e.events={}},o.trigger=function(e,t,n){var o,i,r,s;if(e.events){n||(n={}),o=t.split(" ");for(var a=0;a<o.length;a++)if(i=o[a],r=e.events[i]){(s=c.clone(n,!1)).name=i,s.source=e;for(var l=0;l<r.length;l++)r[l].apply(e,[s])}}}},{"./Common":14}],17:[function(e,t,n){var o={};t.exports=o;var i=e("./Plugin"),r=e("./Common");o.name="matter-js",o.version="0.14.2",o.uses=[],o.used=[],o.use=function(){i.use(o,Array.prototype.slice.call(arguments))},o.before=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathBefore(o,e,t)},o.after=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathAfter(o,e,t)}},{"./Common":14,"./Plugin":20}],18:[function(e,t,n){},{"../body/Composite":2,"./Common":14}],19:[function(e,t,n){var o={};t.exports=o;var i=e("../core/Common");o.create=function(e){var n={};return e||i.log("Mouse.create: element was undefined, defaulting to document.body","warn"),n.element=e||document.body,n.absolute={x:0,y:0},n.position={x:0,y:0},n.mousedownPosition={x:0,y:0},n.mouseupPosition={x:0,y:0},n.offset={x:0,y:0},n.scale={x:1,y:1},n.wheelDelta=0,n.button=-1,n.pixelRatio=n.element.getAttribute("data-pixel-ratio")||1,n.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},n.mousemove=function(e){var t=o._getRelativeMousePosition(e,n.element,n.pixelRatio);e.changedTouches&&(n.button=0,e.preventDefault()),n.absolute.x=t.x,n.absolute.y=t.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.sourceEvents.mousemove=e},n.mousedown=function(e){var t=o._getRelativeMousePosition(e,n.element,n.pixelRatio);e.changedTouches?(n.button=0,e.preventDefault()):n.button=e.button,n.absolute.x=t.x,n.absolute.y=t.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.mousedownPosition.x=n.position.x,n.mousedownPosition.y=n.position.y,n.sourceEvents.mousedown=e},n.mouseup=function(e){var t=o._getRelativeMousePosition(e,n.element,n.pixelRatio);e.changedTouches&&e.preventDefault(),n.button=-1,n.absolute.x=t.x,n.absolute.y=t.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.mouseupPosition.x=n.position.x,n.mouseupPosition.y=n.position.y,n.sourceEvents.mouseup=e},n.mousewheel=function(e){n.wheelDelta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),e.preventDefault()},o.setElement(n,n.element),n},o.setElement=function(e,t){(e.element=t).addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},o.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},o.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},o.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},o._getRelativeMousePosition=function(e,t,n){var o,i,r=t.getBoundingClientRect(),s=document.documentElement||document.body.parentNode||document.body,a=void 0!==window.pageXOffset?window.pageXOffset:s.scrollLeft,l=void 0!==window.pageYOffset?window.pageYOffset:s.scrollTop,c=e.changedTouches;return i=c?(o=c[0].pageX-r.left-a,c[0].pageY-r.top-l):(o=e.pageX-r.left-a,e.pageY-r.top-l),{x:o/(t.clientWidth/(t.width||t.clientWidth)*n),y:i/(t.clientHeight/(t.height||t.clientHeight)*n)}}},{"../core/Common":14}],20:[function(e,t,n){var a={};t.exports=a;var l=e("./Common");a._registry={},a.register=function(e){if(a.isPlugin(e)||l.warn("Plugin.register:",a.toString(e),"does not implement all required fields."),e.name in a._registry){var t=a._registry[e.name],n=a.versionParse(e.version).number,o=a.versionParse(t.version).number;o<n?(l.warn("Plugin.register:",a.toString(t),"was upgraded to",a.toString(e)),a._registry[e.name]=e):n<o?l.warn("Plugin.register:",a.toString(t),"can not be downgraded to",a.toString(e)):e!==t&&l.warn("Plugin.register:",a.toString(e),"is already registered to different plugin object")}else a._registry[e.name]=e;return e},a.resolve=function(e){return a._registry[a.dependencyParse(e).name]},a.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},a.isPlugin=function(e){return e&&e.name&&e.version&&e.install},a.isUsed=function(e,t){return-1<e.used.indexOf(t)},a.isFor=function(e,t){var n=e.for&&a.dependencyParse(e.for);return!e.for||t.name===n.name&&a.versionSatisfies(t.version,n.range)},a.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0!==e.uses.length){for(var n=a.dependencies(e),o=l.topologicalSort(n),i=[],r=0;r<o.length;r+=1)if(o[r]!==e.name){var s=a.resolve(o[r]);s?a.isUsed(e,s.name)||(a.isFor(s,e)||(l.warn("Plugin.use:",a.toString(s),"is for",s.for,"but installed on",a.toString(e)+"."),s._warned=!0),s.install?s.install(e):(l.warn("Plugin.use:",a.toString(s),"does not specify an install function."),s._warned=!0),s._warned?(i.push("🔶 "+a.toString(s)),delete s._warned):i.push("✅ "+a.toString(s)),e.used.push(s.name)):i.push("❌ "+o[r])}0<i.length&&l.info(i.join("  "))}else l.warn("Plugin.use:",a.toString(e),"does not specify any dependencies to install.")},a.dependencies=function(o,e){var i=a.dependencyParse(o),t=i.name;if(!(t in(e=e||{}))){o=a.resolve(o)||o,e[t]=l.map(o.uses||[],function(e){a.isPlugin(e)&&a.register(e);var t=a.dependencyParse(e),n=a.resolve(e);return n&&!a.versionSatisfies(n.version,t.range)?(l.warn("Plugin.dependencies:",a.toString(n),"does not satisfy",a.toString(t),"used by",a.toString(i)+"."),n._warned=!0,o._warned=!0):n||(l.warn("Plugin.dependencies:",a.toString(e),"used by",a.toString(i),"could not be resolved."),o._warned=!0),t.name});for(var n=0;n<e[t].length;n+=1)a.dependencies(e[t][n],e);return e}},a.dependencyParse=function(e){return l.isString(e)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(e)||l.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}):{name:e.name,range:e.range||e.version}},a.versionParse=function(e){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(e)||l.warn("Plugin.versionParse:",e,"is not a valid version or range.");var t=e.split("-");e=t[0];var n=isNaN(Number(e[0])),o=n?e.substr(1):e,i=l.map(o.split("."),function(e){return Number(e)});return{isRange:n,version:o,range:e,operator:n?e[0]:"",parts:i,prerelease:t[1],number:1e8*i[0]+1e4*i[1]+i[2]}},a.versionSatisfies=function(e,t){t=t||"*";var n=a.versionParse(t),o=n.parts,i=a.versionParse(e),r=i.parts;if(n.isRange){if("*"===n.operator||"*"===e)return!0;if("~"===n.operator)return r[0]===o[0]&&r[1]===o[1]&&r[2]>=o[2];if("^"===n.operator)return 0<o[0]?r[0]===o[0]&&i.number>=n.number:0<o[1]?r[1]===o[1]&&r[2]>=o[2]:r[2]===o[2]}return e===t||"*"===e}},{"./Common":14}],21:[function(e,t,n){var r={};t.exports=r;var a=e("./Events"),l=e("./Engine"),o=e("./Common");!function(){var i,t,n;("undefined"!=typeof window&&(i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i)||(i=function(e){n=setTimeout(function(){e(o.now())},1e3/60)},t=function(){clearTimeout(n)});r.create=function(e){var t=o.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},e);return t.delta=t.delta||1e3/t.fps,t.deltaMin=t.deltaMin||1e3/t.fps,t.deltaMax=t.deltaMax||1e3/(.5*t.fps),t.fps=1e3/t.delta,t},r.run=function(n,o){return void 0!==n.positionIterations&&(o=n,n=r.create()),function e(t){n.frameRequestId=i(e),t&&n.enabled&&r.tick(n,o,t)}(),n},r.tick=function(e,t,n){var o,i=t.timing,r=1,s={timestamp:i.timestamp};a.trigger(e,"beforeTick",s),a.trigger(t,"beforeTick",s),e.isFixed?o=e.delta:(o=n-e.timePrev||e.delta,e.timePrev=n,e.deltaHistory.push(o),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),r=(o=(o=(o=Math.min.apply(null,e.deltaHistory))<e.deltaMin?e.deltaMin:o)>e.deltaMax?e.deltaMax:o)/e.delta,e.delta=o),0!==e.timeScalePrev&&(r*=i.timeScale/e.timeScalePrev),0===i.timeScale&&(r=0),e.timeScalePrev=i.timeScale,e.correction=r,e.frameCounter+=1,1e3<=n-e.counterTimestamp&&(e.fps=e.frameCounter*((n-e.counterTimestamp)/1e3),e.counterTimestamp=n,e.frameCounter=0),a.trigger(e,"tick",s),a.trigger(t,"tick",s),t.world.isModified&&t.render&&t.render.controller&&t.render.controller.clear&&t.render.controller.clear(t.render),a.trigger(e,"beforeUpdate",s),l.update(t,o,r),a.trigger(e,"afterUpdate",s),t.render&&t.render.controller&&(a.trigger(e,"beforeRender",s),a.trigger(t,"beforeRender",s),t.render.controller.world(t.render),a.trigger(e,"afterRender",s),a.trigger(t,"afterRender",s)),a.trigger(e,"afterTick",s),a.trigger(t,"afterTick",s)},r.stop=function(e){t(e.frameRequestId)},r.start=function(e,t){r.run(e,t)}}()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(e,t,n){var d={};t.exports=d;var o=e("./Events");d._motionWakeThreshold=.18,d._motionSleepThreshold=.08,d._minBias=.9,d.update=function(e,t){for(var n=t*t*t,o=0;o<e.length;o++){var i=e[o],r=i.speed*i.speed+i.angularSpeed*i.angularSpeed;if(0===i.force.x&&0===i.force.y){var s=Math.min(i.motion,r),a=Math.max(i.motion,r);i.motion=d._minBias*s+(1-d._minBias)*a,0<i.sleepThreshold&&i.motion<d._motionSleepThreshold*n?(i.sleepCounter+=1,i.sleepCounter>=i.sleepThreshold&&d.set(i,!0)):0<i.sleepCounter&&(i.sleepCounter-=1)}else d.set(i,!1)}},d.afterCollisions=function(e,t){for(var n=t*t*t,o=0;o<e.length;o++){var i=e[o];if(i.isActive){var r=i.collision,s=r.bodyA.parent,a=r.bodyB.parent;if(!(s.isSleeping&&a.isSleeping||s.isStatic||a.isStatic)&&(s.isSleeping||a.isSleeping)){var l=s.isSleeping&&!s.isStatic?s:a,c=l===s?a:s;!l.isStatic&&c.motion>d._motionWakeThreshold*n&&d.set(l,!1)}}}},d.set=function(e,t){var n=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,n||o.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,n&&o.trigger(e,"sleepEnd"))}},{"./Events":16}],23:[function(e,t,n){var f={};t.exports=f;var P,B=e("../geometry/Vertices"),M=e("../core/Common"),k=e("../body/Body"),I=e("../geometry/Bounds"),_=e("../geometry/Vector");f.rectangle=function(e,t,n,o,i){i=i||{};var r={label:"Rectangle Body",position:{x:e,y:t},vertices:B.fromPath("L 0 0 L "+n+" 0 L "+n+" "+o+" L 0 "+o)};if(i.chamfer){var s=i.chamfer;r.vertices=B.chamfer(r.vertices,s.radius,s.quality,s.qualityMin,s.qualityMax),delete i.chamfer}return k.create(M.extend({},r,i))},f.trapezoid=function(e,t,n,o,i,r){r=r||{};var s,a=n*(i*=.5),l=a+(1-2*i)*n,c=l+a;s=i<.5?"L 0 0 L "+a+" "+-o+" L "+l+" "+-o+" L "+c+" 0":"L 0 0 L "+l+" "+-o+" L "+c+" 0";var d={label:"Trapezoid Body",position:{x:e,y:t},vertices:B.fromPath(s)};if(r.chamfer){var u=r.chamfer;d.vertices=B.chamfer(d.vertices,u.radius,u.quality,u.qualityMin,u.qualityMax),delete r.chamfer}return k.create(M.extend({},d,r))},f.circle=function(e,t,n,o,i){o=o||{};var r={label:"Circle Body",circleRadius:n};i=i||25;var s=Math.ceil(Math.max(10,Math.min(i,n)));return s%2==1&&(s+=1),f.polygon(e,t,s,n,M.extend({},r,o))},f.polygon=function(e,t,n,o,i){if(i=i||{},n<3)return f.circle(e,t,o,i);for(var r=2*Math.PI/n,s="",a=.5*r,l=0;l<n;l+=1){var c=a+l*r,d=Math.cos(c)*o,u=Math.sin(c)*o;s+="L "+d.toFixed(3)+" "+u.toFixed(3)+" "}var p={label:"Polygon Body",position:{x:e,y:t},vertices:B.fromPath(s)};if(i.chamfer){var m=i.chamfer;p.vertices=B.chamfer(p.vertices,m.radius,m.quality,m.qualityMin,m.qualityMax),delete i.chamfer}return k.create(M.extend({},p,i))},f.fromVertices=function(e,t,n,o,i,r,s){var a,l,c,d,u,p,m,f,v;for(P||(P=M._requireGlobal("decomp","poly-decomp")),o=o||{},l=[],i=void 0!==i&&i,r=void 0!==r?r:.01,s=void 0!==s?s:10,P||M.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),M.isArray(n[0])||(n=[n]),f=0;f<n.length;f+=1)if(d=n[f],(c=B.isConvex(d))||!P)d=c?B.clockwiseSort(d):B.hull(d),l.push({position:{x:e,y:t},vertices:d});else{var y=d.map(function(e){return[e.x,e.y]});P.makeCCW(y),!1!==r&&P.removeCollinearPoints(y,r);var g=P.quickDecomp(y);for(u=0;u<g.length;u++){var x=g[u].map(function(e){return{x:e[0],y:e[1]}});0<s&&B.area(x)<s||l.push({position:B.centre(x),vertices:x})}}for(u=0;u<l.length;u++)l[u]=k.create(M.extend(l[u],o));if(i)for(u=0;u<l.length;u++){var h=l[u];for(p=u+1;p<l.length;p++){var b=l[p];if(I.overlaps(h.bounds,b.bounds)){var w=h.vertices,S=b.vertices;for(m=0;m<h.vertices.length;m++)for(v=0;v<b.vertices.length;v++){var C=_.magnitudeSquared(_.sub(w[(m+1)%w.length],S[v])),A=_.magnitudeSquared(_.sub(w[m],S[(v+1)%S.length]));C<5&&A<5&&(w[m].isInternal=!0,S[v].isInternal=!0)}}}}return 1<l.length?(a=k.create(M.extend({parts:l.slice(0)},o)),k.setPosition(a,{x:e,y:t}),a):l[0]}},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(e,t,n){var m={};t.exports=m;var x=e("../body/Composite"),v=e("../constraint/Constraint"),y=e("../core/Common"),h=e("../body/Body"),f=e("./Bodies");m.stack=function(e,t,n,o,i,r,s){for(var a,l=x.create({label:"Stack"}),c=e,d=t,u=0,p=0;p<o;p++){for(var m=0,f=0;f<n;f++){var v=s(c,d,f,p,a,u);if(v){var y=v.bounds.max.y-v.bounds.min.y,g=v.bounds.max.x-v.bounds.min.x;m<y&&(m=y),h.translate(v,{x:.5*g,y:.5*y}),c=v.bounds.max.x+i,x.addBody(l,v),a=v,u+=1}else c+=i}d+=m+r,c=e}return l},m.chain=function(e,t,n,o,i,r){for(var s=e.bodies,a=1;a<s.length;a++){var l=s[a-1],c=s[a],d=l.bounds.max.y-l.bounds.min.y,u=l.bounds.max.x-l.bounds.min.x,p=c.bounds.max.y-c.bounds.min.y,m={bodyA:l,pointA:{x:u*t,y:d*n},bodyB:c,pointB:{x:(c.bounds.max.x-c.bounds.min.x)*o,y:p*i}},f=y.extend(m,r);x.addConstraint(e,v.create(f))}return e.label+=" Chain",e},m.mesh=function(e,t,n,o,i){var r,s,a,l,c,d=e.bodies;for(r=0;r<n;r++){for(s=1;s<t;s++)a=d[s-1+r*t],l=d[s+r*t],x.addConstraint(e,v.create(y.extend({bodyA:a,bodyB:l},i)));if(0<r)for(s=0;s<t;s++)a=d[s+(r-1)*t],l=d[s+r*t],x.addConstraint(e,v.create(y.extend({bodyA:a,bodyB:l},i))),o&&0<s&&(c=d[s-1+(r-1)*t],x.addConstraint(e,v.create(y.extend({bodyA:c,bodyB:l},i)))),o&&s<t-1&&(c=d[s+1+(r-1)*t],x.addConstraint(e,v.create(y.extend({bodyA:c,bodyB:l},i))))}return e.label+=" Mesh",e},m.pyramid=function(l,e,c,d,u,t,p){return m.stack(l,e,c,d,u,t,function(e,t,n,o,i,r){var s=Math.min(d,Math.ceil(c/2)),a=i?i.bounds.max.x-i.bounds.min.x:0;if(!(s<o||n<(o=s-o)||c-1-o<n))return 1===r&&h.translate(i,{x:(n+(c%2==1?1:-1))*a,y:0}),p(l+(i?n*a:0)+n*u,t,n,o,i,r)})},m.newtonsCradle=function(e,t,n,o,i){for(var r=x.create({label:"Newtons Cradle"}),s=0;s<n;s++){var a=f.circle(e+s*(1.9*o),t+i,o,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),l=v.create({pointA:{x:e+s*(1.9*o),y:t},bodyB:a});x.addBody(r,a),x.addConstraint(r,l)}return r},m.car=function(e,t,n,o,i){var r=h.nextGroup(!0),s=.5*-n+20,a=.5*n-20,l=x.create({label:"Car"}),c=f.rectangle(e,t,n,o,{collisionFilter:{group:r},chamfer:{radius:.5*o},density:2e-4}),d=f.circle(e+s,t+0,i,{collisionFilter:{group:r},friction:.8}),u=f.circle(e+a,t+0,i,{collisionFilter:{group:r},friction:.8}),p=v.create({bodyB:c,pointB:{x:s,y:0},bodyA:d,stiffness:1,length:0}),m=v.create({bodyB:c,pointB:{x:a,y:0},bodyA:u,stiffness:1,length:0});return x.addBody(l,c),x.addBody(l,d),x.addBody(l,u),x.addConstraint(l,p),x.addConstraint(l,m),l},m.softBody=function(e,t,n,o,i,r,s,a,l,c){l=y.extend({inertia:1/0},l),c=y.extend({stiffness:.2,render:{type:"line",anchors:!1}},c);var d=m.stack(e,t,n,o,i,r,function(e,t){return f.circle(e,t,a,l)});return m.mesh(d,n,o,s,c),d.label="Soft Body",d}},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(e,t,n){var o={};t.exports=o;var s=e("../geometry/Vector"),a=e("../core/Common");o.fromVertices=function(e){for(var t={},n=0;n<e.length;n++){var o=(n+1)%e.length,i=s.normalise({x:e[o].y-e[n].y,y:e[n].x-e[o].x}),r=0===i.y?1/0:i.x/i.y;t[r=r.toFixed(3).toString()]=i}return a.values(t)},o.rotate=function(e,t){if(0!==t)for(var n=Math.cos(t),o=Math.sin(t),i=0;i<e.length;i++){var r,s=e[i];r=s.x*n-s.y*o,s.y=s.x*o+s.y*n,s.x=r}}},{"../core/Common":14,"../geometry/Vector":28}],26:[function(e,t,n){var o={};(t.exports=o).create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&o.update(t,e),t},o.update=function(e,t,n){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var o=0;o<t.length;o++){var i=t[o];i.x>e.max.x&&(e.max.x=i.x),i.x<e.min.x&&(e.min.x=i.x),i.y>e.max.y&&(e.max.y=i.y),i.y<e.min.y&&(e.min.y=i.y)}n&&(0<n.x?e.max.x+=n.x:e.min.x+=n.x,0<n.y?e.max.y+=n.y:e.min.y+=n.y)},o.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},o.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},o.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},o.shift=function(e,t){var n=e.max.x-e.min.x,o=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+n,e.min.y=t.y,e.max.y=t.y+o}},{}],27:[function(e,t,n){var h={};t.exports=h;e("../geometry/Bounds");var b=e("../core/Common");h.pathToVertices=function(e,t){"undefined"==typeof window||"SVGPathSeg"in window||b.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var n,o,i,r,s,a,l,c,d,u,p,m=[],f=0,v=0,y=0;t=t||15;var g=function(e,t,n){var o=n%2==1&&1<n;if(!d||e!=d.x||t!=d.y){p=d&&o?(u=d.x,d.y):u=0;var i={x:u+e,y:p+t};!o&&d||(d=i),m.push(i),v=u+e,y=p+t}},x=function(e){var t=e.pathSegTypeAsLetter.toUpperCase();if("Z"!==t){switch(t){case"M":case"L":case"T":case"C":case"S":case"Q":v=e.x,y=e.y;break;case"H":v=e.x;break;case"V":y=e.y}g(v,y,e.pathSegType)}};for(h._svgPathToAbsolute(e),i=e.getTotalLength(),a=[],n=0;n<e.pathSegList.numberOfItems;n+=1)a.push(e.pathSegList.getItem(n));for(l=a.concat();f<i;){if((s=a[e.getPathSegAtLength(f)])!=c){for(;l.length&&l[0]!=s;)x(l.shift());c=s}switch(s.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":r=e.getPointAtLength(f),g(r.x,r.y,0)}f+=t}for(n=0,o=l.length;n<o;++n)x(l[n]);return m},h._svgPathToAbsolute=function(e){for(var t,n,o,i,r,s,a=e.pathSegList,l=0,c=0,d=a.numberOfItems,u=0;u<d;++u){var p=a.getItem(u),m=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(m))"x"in p&&(l=p.x),"y"in p&&(c=p.y);else switch("x1"in p&&(o=l+p.x1),"x2"in p&&(r=l+p.x2),"y1"in p&&(i=c+p.y1),"y2"in p&&(s=c+p.y2),"x"in p&&(l+=p.x),"y"in p&&(c+=p.y),m){case"m":a.replaceItem(e.createSVGPathSegMovetoAbs(l,c),u);break;case"l":a.replaceItem(e.createSVGPathSegLinetoAbs(l,c),u);break;case"h":a.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(l),u);break;case"v":a.replaceItem(e.createSVGPathSegLinetoVerticalAbs(c),u);break;case"c":a.replaceItem(e.createSVGPathSegCurvetoCubicAbs(l,c,o,i,r,s),u);break;case"s":a.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(l,c,r,s),u);break;case"q":a.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(l,c,o,i),u);break;case"t":a.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(l,c),u);break;case"a":a.replaceItem(e.createSVGPathSegArcAbs(l,c,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),u);break;case"z":case"Z":l=t,c=n}"M"!=m&&"m"!=m||(t=l,n=c)}}},{"../core/Common":14,"../geometry/Bounds":26}],28:[function(e,t,n){var o={};(t.exports=o).create=function(e,t){return{x:e||0,y:t||0}},o.clone=function(e){return{x:e.x,y:e.y}},o.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},o.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},o.rotate=function(e,t,n){var o=Math.cos(t),i=Math.sin(t);n||(n={});var r=e.x*o-e.y*i;return n.y=e.x*i+e.y*o,n.x=r,n},o.rotateAbout=function(e,t,n,o){var i=Math.cos(t),r=Math.sin(t);o||(o={});var s=n.x+((e.x-n.x)*i-(e.y-n.y)*r);return o.y=n.y+((e.x-n.x)*r+(e.y-n.y)*i),o.x=s,o},o.normalise=function(e){var t=o.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},o.dot=function(e,t){return e.x*t.x+e.y*t.y},o.cross=function(e,t){return e.x*t.y-e.y*t.x},o.cross3=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)},o.add=function(e,t,n){return n||(n={}),n.x=e.x+t.x,n.y=e.y+t.y,n},o.sub=function(e,t,n){return n||(n={}),n.x=e.x-t.x,n.y=e.y-t.y,n},o.mult=function(e,t){return{x:e.x*t,y:e.y*t}},o.div=function(e,t){return{x:e.x/t,y:e.y/t}},o.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},o.neg=function(e){return{x:-e.x,y:-e.y}},o.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},o._temp=[o.create(),o.create(),o.create(),o.create(),o.create(),o.create()]},{}],29:[function(e,t,n){var a={};t.exports=a;var b=e("../geometry/Vector"),w=e("../core/Common");a.create=function(e,t){for(var n=[],o=0;o<e.length;o++){var i=e[o],r={x:i.x,y:i.y,index:o,body:t,isInternal:!1};n.push(r)}return n},a.fromPath=function(e,t){var o=[];return e.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/gi,function(e,t,n){o.push({x:parseFloat(t),y:parseFloat(n)})}),a.create(o,t)},a.centre=function(e){for(var t,n,o,i=a.area(e,!0),r={x:0,y:0},s=0;s<e.length;s++)o=(s+1)%e.length,t=b.cross(e[s],e[o]),n=b.mult(b.add(e[s],e[o]),t),r=b.add(r,n);return b.div(r,6*i)},a.mean=function(e){for(var t={x:0,y:0},n=0;n<e.length;n++)t.x+=e[n].x,t.y+=e[n].y;return b.div(t,e.length)},a.area=function(e,t){for(var n=0,o=e.length-1,i=0;i<e.length;i++)n+=(e[o].x-e[i].x)*(e[o].y+e[i].y),o=i;return t?n/2:Math.abs(n)/2},a.inertia=function(e,t){for(var n,o,i=0,r=0,s=e,a=0;a<s.length;a++)o=(a+1)%s.length,i+=(n=Math.abs(b.cross(s[o],s[a])))*(b.dot(s[o],s[o])+b.dot(s[o],s[a])+b.dot(s[a],s[a])),r+=n;return t/6*(i/r)},a.translate=function(e,t,n){var o;if(n)for(o=0;o<e.length;o++)e[o].x+=t.x*n,e[o].y+=t.y*n;else for(o=0;o<e.length;o++)e[o].x+=t.x,e[o].y+=t.y;return e},a.rotate=function(e,t,n){if(0!==t){for(var o=Math.cos(t),i=Math.sin(t),r=0;r<e.length;r++){var s=e[r],a=s.x-n.x,l=s.y-n.y;s.x=n.x+(a*o-l*i),s.y=n.y+(a*i+l*o)}return e}},a.contains=function(e,t){for(var n=0;n<e.length;n++){var o=e[n],i=e[(n+1)%e.length];if(0<(t.x-o.x)*(i.y-o.y)+(t.y-o.y)*(o.x-i.x))return!1}return!0},a.scale=function(e,t,n,o){if(1===t&&1===n)return e;var i,r;o=o||a.centre(e);for(var s=0;s<e.length;s++)i=e[s],r=b.sub(i,o),e[s].x=o.x+r.x*t,e[s].y=o.y+r.y*n;return e},a.chamfer=function(e,t,n,o,i){t="number"==typeof t?[t]:t||[8],n=void 0!==n?n:-1,o=o||2,i=i||14;for(var r=[],s=0;s<e.length;s++){var a=e[0<=s-1?s-1:e.length-1],l=e[s],c=e[(s+1)%e.length],d=t[s<t.length?s:t.length-1];if(0!==d){var u=b.normalise({x:l.y-a.y,y:a.x-l.x}),p=b.normalise({x:c.y-l.y,y:l.x-c.x}),m=Math.sqrt(2*Math.pow(d,2)),f=b.mult(w.clone(u),d),v=b.normalise(b.mult(b.add(u,p),.5)),y=b.sub(l,b.mult(v,m)),g=n;-1===n&&(g=1.75*Math.pow(d,.32)),(g=w.clamp(g,o,i))%2==1&&(g+=1);for(var x=Math.acos(b.dot(u,p))/g,h=0;h<g;h++)r.push(b.add(b.rotate(f,x*h),y))}else r.push(l)}return r},a.clockwiseSort=function(e){var n=a.mean(e);return e.sort(function(e,t){return b.angle(n,e)-b.angle(n,t)}),e},a.isConvex=function(e){var t,n,o,i,r=0,s=e.length;if(s<3)return null;for(t=0;t<s;t++)if(o=(t+2)%s,i=(e[n=(t+1)%s].x-e[t].x)*(e[o].y-e[n].y),(i-=(e[n].y-e[t].y)*(e[o].x-e[n].x))<0?r|=1:0<i&&(r|=2),3===r)return!1;return 0!==r||null},a.hull=function(e){var t,n,o=[],i=[];for((e=e.slice(0)).sort(function(e,t){var n=e.x-t.x;return 0!==n?n:e.y-t.y}),n=0;n<e.length;n+=1){for(t=e[n];2<=i.length&&b.cross3(i[i.length-2],i[i.length-1],t)<=0;)i.pop();i.push(t)}for(n=e.length-1;0<=n;n-=1){for(t=e[n];2<=o.length&&b.cross3(o[o.length-2],o[o.length-1],t)<=0;)o.pop();o.push(t)}return o.pop(),i.pop(),o.concat(i)}},{"../core/Common":14,"../geometry/Vector":28}],30:[function(e,t,n){var o=t.exports=e("../core/Matter");o.Body=e("../body/Body"),o.Composite=e("../body/Composite"),o.World=e("../body/World"),o.Contact=e("../collision/Contact"),o.Detector=e("../collision/Detector"),o.Grid=e("../collision/Grid"),o.Pairs=e("../collision/Pairs"),o.Pair=e("../collision/Pair"),o.Query=e("../collision/Query"),o.Resolver=e("../collision/Resolver"),o.SAT=e("../collision/SAT"),o.Constraint=e("../constraint/Constraint"),o.MouseConstraint=e("../constraint/MouseConstraint"),o.Common=e("../core/Common"),o.Engine=e("../core/Engine"),o.Events=e("../core/Events"),o.Mouse=e("../core/Mouse"),o.Runner=e("../core/Runner"),o.Sleeping=e("../core/Sleeping"),o.Plugin=e("../core/Plugin"),o.Bodies=e("../factory/Bodies"),o.Composites=e("../factory/Composites"),o.Axes=e("../geometry/Axes"),o.Bounds=e("../geometry/Bounds"),o.Svg=e("../geometry/Svg"),o.Vector=e("../geometry/Vector"),o.Vertices=e("../geometry/Vertices"),o.Render=e("../render/Render"),o.RenderPixi=e("../render/RenderPixi"),o.World.add=o.Composite.add,o.World.remove=o.Composite.remove,o.World.addComposite=o.Composite.addComposite,o.World.addBody=o.Composite.addBody,o.World.addConstraint=o.Composite.addConstraint,o.World.clear=o.Composite.clear,o.Engine.run=o.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(e,t,n){var b={};t.exports=b;var y=e("../core/Common"),w=e("../body/Composite"),S=e("../geometry/Bounds"),C=e("../core/Events"),A=e("../collision/Grid"),P=e("../geometry/Vector"),B=e("../core/Mouse");!function(){var o,t;"undefined"!=typeof window&&(o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(y.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),b.create=function(e){var t={controller:b,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},n=y.extend(t,e);return n.canvas&&(n.canvas.width=n.options.width||n.canvas.width,n.canvas.height=n.options.height||n.canvas.height),n.mouse=e.mouse,n.engine=e.engine,n.canvas=n.canvas||i(n.options.width,n.options.height),n.context=n.canvas.getContext("2d"),n.textures={},n.bounds=n.bounds||{min:{x:0,y:0},max:{x:n.canvas.width,y:n.canvas.height}},1!==n.options.pixelRatio&&b.setPixelRatio(n,n.options.pixelRatio),y.isElement(n.element)?n.element.appendChild(n.canvas):n.canvas.parentNode||y.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),n},b.run=function(n){!function e(t){n.frameRequestId=o(e),b.world(n)}()},b.stop=function(e){t(e.frameRequestId)},b.setPixelRatio=function(e,t){var n=e.options,o=e.canvas;"auto"===t&&(t=r(o)),n.pixelRatio=t,o.setAttribute("data-pixel-ratio",t),o.width=n.width*t,o.height=n.height*t,o.style.width=n.width+"px",o.style.height=n.height+"px",e.context.scale(t,t)},b.lookAt=function(e,t,n,o){o=void 0===o||o,t=y.isArray(t)?t:[t],n=n||{x:0,y:0};for(var i={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},r=0;r<t.length;r+=1){var s=t[r],a=s.bounds?s.bounds.min:s.min||s.position||s,l=s.bounds?s.bounds.max:s.max||s.position||s;a&&l&&(a.x<i.min.x&&(i.min.x=a.x),l.x>i.max.x&&(i.max.x=l.x),a.y<i.min.y&&(i.min.y=a.y),l.y>i.max.y&&(i.max.y=l.y))}var c=i.max.x-i.min.x+2*n.x,d=i.max.y-i.min.y+2*n.y,u=e.canvas.height,p=e.canvas.width/u,m=c/d,f=1,v=1;p<m?v=m/p:f=p/m,e.options.hasBounds=!0,e.bounds.min.x=i.min.x,e.bounds.max.x=i.min.x+c*f,e.bounds.min.y=i.min.y,e.bounds.max.y=i.min.y+d*v,o&&(e.bounds.min.x+=.5*c-c*f*.5,e.bounds.max.x+=.5*c-c*f*.5,e.bounds.min.y+=.5*d-d*v*.5,e.bounds.max.y+=.5*d-d*v*.5),e.bounds.min.x-=n.x,e.bounds.max.x-=n.x,e.bounds.min.y-=n.y,e.bounds.max.y-=n.y,e.mouse&&(B.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),B.setOffset(e.mouse,e.bounds.min))},b.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,n=e.bounds.max.y-e.bounds.min.y,o=t/e.options.width,i=n/e.options.height;e.context.scale(1/o,1/i),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},b.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},b.world=function(e){var t,n=e.engine,o=n.world,i=e.canvas,r=e.context,s=e.options,a=w.allBodies(o),l=w.allConstraints(o),c=s.wireframes?s.wireframeBackground:s.background,d=[],u=[],p={timestamp:n.timing.timestamp};if(C.trigger(e,"beforeRender",p),e.currentBackground!==c&&h(e,c),r.globalCompositeOperation="source-in",r.fillStyle="transparent",r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="source-over",s.hasBounds){for(t=0;t<a.length;t++){var m=a[t];S.overlaps(m.bounds,e.bounds)&&d.push(m)}for(t=0;t<l.length;t++){var f=l[t],v=f.bodyA,y=f.bodyB,g=f.pointA,x=f.pointB;v&&(g=P.add(v.position,f.pointA)),y&&(x=P.add(y.position,f.pointB)),g&&x&&((S.contains(e.bounds,g)||S.contains(e.bounds,x))&&u.push(f))}b.startViewTransform(e),e.mouse&&(B.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),B.setOffset(e.mouse,e.bounds.min))}else u=l,d=a;!s.wireframes||n.enableSleeping&&s.showSleeping?b.bodies(e,d,r):(s.showConvexHulls&&b.bodyConvexHulls(e,d,r),b.bodyWireframes(e,d,r)),s.showBounds&&b.bodyBounds(e,d,r),(s.showAxes||s.showAngleIndicator)&&b.bodyAxes(e,d,r),s.showPositions&&b.bodyPositions(e,d,r),s.showVelocity&&b.bodyVelocity(e,d,r),s.showIds&&b.bodyIds(e,d,r),s.showSeparations&&b.separations(e,n.pairs.list,r),s.showCollisions&&b.collisions(e,n.pairs.list,r),s.showVertexNumbers&&b.vertexNumbers(e,d,r),s.showMousePosition&&b.mousePosition(e,e.mouse,r),b.constraints(u,r),s.showBroadphase&&n.broadphase.controller===A&&b.grid(e,n.broadphase,r),s.showDebug&&b.debug(e,r),s.hasBounds&&b.endViewTransform(e),C.trigger(e,"afterRender",p)},b.debug=function(e,t){var n=t,o=e.engine,i=o.world,r=o.metrics,s=e.options;w.allBodies(i);if(500<=o.timing.timestamp-(e.debugTimestamp||0)){var a="";r.timing&&(a+="fps: "+Math.round(r.timing.fps)+"    "),e.debugString=a,e.debugTimestamp=o.timing.timestamp}if(e.debugString){n.font="12px Arial",s.wireframes?n.fillStyle="rgba(255,255,255,0.5)":n.fillStyle="rgba(0,0,0,0.5)";for(var l=e.debugString.split("\n"),c=0;c<l.length;c++)n.fillText(l[c],50,50+18*c)}},b.constraints=function(e,t){for(var n=t,o=0;o<e.length;o++){var i=e[o];if(i.render.visible&&i.pointA&&i.pointB){var r,s,a=i.bodyA,l=i.bodyB;if(r=a?P.add(a.position,i.pointA):i.pointA,"pin"===i.render.type)n.beginPath(),n.arc(r.x,r.y,3,0,2*Math.PI),n.closePath();else{if(s=l?P.add(l.position,i.pointB):i.pointB,n.beginPath(),n.moveTo(r.x,r.y),"spring"===i.render.type)for(var c,d=P.sub(s,r),u=P.perp(P.normalise(d)),p=Math.ceil(y.clamp(i.length/5,12,20)),m=1;m<p;m+=1)c=m%2==0?1:-1,n.lineTo(r.x+d.x*(m/p)+u.x*c*4,r.y+d.y*(m/p)+u.y*c*4);n.lineTo(s.x,s.y)}i.render.lineWidth&&(n.lineWidth=i.render.lineWidth,n.strokeStyle=i.render.strokeStyle,n.stroke()),i.render.anchors&&(n.fillStyle=i.render.strokeStyle,n.beginPath(),n.arc(r.x,r.y,3,0,2*Math.PI),n.arc(s.x,s.y,3,0,2*Math.PI),n.closePath(),n.fill())}}},b.bodyShadows=function(e,t,n){for(var o=n,i=(e.engine,0);i<t.length;i++){var r=t[i];if(r.render.visible){if(r.circleRadius)o.beginPath(),o.arc(r.position.x,r.position.y,r.circleRadius,0,2*Math.PI),o.closePath();else{o.beginPath(),o.moveTo(r.vertices[0].x,r.vertices[0].y);for(var s=1;s<r.vertices.length;s++)o.lineTo(r.vertices[s].x,r.vertices[s].y);o.closePath()}var a=r.position.x-.5*e.options.width,l=r.position.y-.2*e.options.height,c=Math.abs(a)+Math.abs(l);o.shadowColor="rgba(0,0,0,0.15)",o.shadowOffsetX=.05*a,o.shadowOffsetY=.05*l,o.shadowBlur=1+12*Math.min(1,c/1e3),o.fill(),o.shadowColor=null,o.shadowOffsetX=null,o.shadowOffsetY=null,o.shadowBlur=null}}},b.bodies=function(e,t,n){var o,i,r,s,a=n,l=(e.engine,e.options),c=l.showInternalEdges||!l.wireframes;for(r=0;r<t.length;r++)if((o=t[r]).render.visible)for(s=1<o.parts.length?1:0;s<o.parts.length;s++)if((i=o.parts[s]).render.visible){if(l.showSleeping&&o.isSleeping?a.globalAlpha=.5*i.render.opacity:1!==i.render.opacity&&(a.globalAlpha=i.render.opacity),i.render.sprite&&i.render.sprite.texture&&!l.wireframes){var d=i.render.sprite,u=m(e,d.texture);a.translate(i.position.x,i.position.y),a.rotate(i.angle),a.drawImage(u,u.width*-d.xOffset*d.xScale,u.height*-d.yOffset*d.yScale,u.width*d.xScale,u.height*d.yScale),a.rotate(-i.angle),a.translate(-i.position.x,-i.position.y)}else{if(i.circleRadius)a.beginPath(),a.arc(i.position.x,i.position.y,i.circleRadius,0,2*Math.PI);else{a.beginPath(),a.moveTo(i.vertices[0].x,i.vertices[0].y);for(var p=1;p<i.vertices.length;p++)!i.vertices[p-1].isInternal||c?a.lineTo(i.vertices[p].x,i.vertices[p].y):a.moveTo(i.vertices[p].x,i.vertices[p].y),i.vertices[p].isInternal&&!c&&a.moveTo(i.vertices[(p+1)%i.vertices.length].x,i.vertices[(p+1)%i.vertices.length].y);a.lineTo(i.vertices[0].x,i.vertices[0].y),a.closePath()}l.wireframes?(a.lineWidth=1,a.strokeStyle="#bbb",a.stroke()):(a.fillStyle=i.render.fillStyle,i.render.lineWidth&&(a.lineWidth=i.render.lineWidth,a.strokeStyle=i.render.strokeStyle,a.stroke()),a.fill())}a.globalAlpha=1}},b.bodyWireframes=function(e,t,n){var o,i,r,s,a,l=n,c=e.options.showInternalEdges;for(l.beginPath(),r=0;r<t.length;r++)if((o=t[r]).render.visible)for(a=1<o.parts.length?1:0;a<o.parts.length;a++){for(i=o.parts[a],l.moveTo(i.vertices[0].x,i.vertices[0].y),s=1;s<i.vertices.length;s++)!i.vertices[s-1].isInternal||c?l.lineTo(i.vertices[s].x,i.vertices[s].y):l.moveTo(i.vertices[s].x,i.vertices[s].y),i.vertices[s].isInternal&&!c&&l.moveTo(i.vertices[(s+1)%i.vertices.length].x,i.vertices[(s+1)%i.vertices.length].y);l.lineTo(i.vertices[0].x,i.vertices[0].y)}l.lineWidth=1,l.strokeStyle="#bbb",l.stroke()},b.bodyConvexHulls=function(e,t,n){var o,i,r,s=n;for(s.beginPath(),i=0;i<t.length;i++)if((o=t[i]).render.visible&&1!==o.parts.length){for(s.moveTo(o.vertices[0].x,o.vertices[0].y),r=1;r<o.vertices.length;r++)s.lineTo(o.vertices[r].x,o.vertices[r].y);s.lineTo(o.vertices[0].x,o.vertices[0].y)}s.lineWidth=1,s.strokeStyle="rgba(255,255,255,0.2)",s.stroke()},b.vertexNumbers=function(e,t,n){var o,i,r,s=n;for(o=0;o<t.length;o++){var a=t[o].parts;for(r=1<a.length?1:0;r<a.length;r++){var l=a[r];for(i=0;i<l.vertices.length;i++)s.fillStyle="rgba(255,255,255,0.2)",s.fillText(o+"_"+i,l.position.x+.8*(l.vertices[i].x-l.position.x),l.position.y+.8*(l.vertices[i].y-l.position.y))}}},b.mousePosition=function(e,t,n){var o=n;o.fillStyle="rgba(255,255,255,0.8)",o.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},b.bodyBounds=function(e,t,n){var o=n,i=(e.engine,e.options);o.beginPath();for(var r=0;r<t.length;r++){if(t[r].render.visible)for(var s=t[r].parts,a=1<s.length?1:0;a<s.length;a++){var l=s[a];o.rect(l.bounds.min.x,l.bounds.min.y,l.bounds.max.x-l.bounds.min.x,l.bounds.max.y-l.bounds.min.y)}}i.wireframes?o.strokeStyle="rgba(255,255,255,0.08)":o.strokeStyle="rgba(0,0,0,0.1)",o.lineWidth=1,o.stroke()},b.bodyAxes=function(e,t,n){var o,i,r,s,a=n,l=(e.engine,e.options);for(a.beginPath(),i=0;i<t.length;i++){var c=t[i],d=c.parts;if(c.render.visible)if(l.showAxes)for(r=1<d.length?1:0;r<d.length;r++)for(o=d[r],s=0;s<o.axes.length;s++){var u=o.axes[s];a.moveTo(o.position.x,o.position.y),a.lineTo(o.position.x+20*u.x,o.position.y+20*u.y)}else for(r=1<d.length?1:0;r<d.length;r++)for(o=d[r],s=0;s<o.axes.length;s++)a.moveTo(o.position.x,o.position.y),a.lineTo((o.vertices[0].x+o.vertices[o.vertices.length-1].x)/2,(o.vertices[0].y+o.vertices[o.vertices.length-1].y)/2)}l.wireframes?(a.strokeStyle="indianred",a.lineWidth=1):(a.strokeStyle="rgba(255, 255, 255, 0.4)",a.globalCompositeOperation="overlay",a.lineWidth=2),a.stroke(),a.globalCompositeOperation="source-over"},b.bodyPositions=function(e,t,n){var o,i,r,s,a=n,l=(e.engine,e.options);for(a.beginPath(),r=0;r<t.length;r++)if((o=t[r]).render.visible)for(s=0;s<o.parts.length;s++)i=o.parts[s],a.arc(i.position.x,i.position.y,3,0,2*Math.PI,!1),a.closePath();for(l.wireframes?a.fillStyle="indianred":a.fillStyle="rgba(0,0,0,0.5)",a.fill(),a.beginPath(),r=0;r<t.length;r++)(o=t[r]).render.visible&&(a.arc(o.positionPrev.x,o.positionPrev.y,2,0,2*Math.PI,!1),a.closePath());a.fillStyle="rgba(255,165,0,0.8)",a.fill()},b.bodyVelocity=function(e,t,n){var o=n;o.beginPath();for(var i=0;i<t.length;i++){var r=t[i];r.render.visible&&(o.moveTo(r.position.x,r.position.y),o.lineTo(r.position.x+2*(r.position.x-r.positionPrev.x),r.position.y+2*(r.position.y-r.positionPrev.y)))}o.lineWidth=3,o.strokeStyle="cornflowerblue",o.stroke()},b.bodyIds=function(e,t,n){var o,i,r=n;for(o=0;o<t.length;o++)if(t[o].render.visible){var s=t[o].parts;for(i=1<s.length?1:0;i<s.length;i++){var a=s[i];r.font="12px Arial",r.fillStyle="rgba(255,255,255,0.5)",r.fillText(a.id,a.position.x+10,a.position.y-10)}}},b.collisions=function(e,t,n){var o,i,r,s,a=n,l=e.options;for(a.beginPath(),r=0;r<t.length;r++)if((o=t[r]).isActive)for(i=o.collision,s=0;s<o.activeContacts.length;s++){var c=o.activeContacts[s].vertex;a.rect(c.x-1.5,c.y-1.5,3.5,3.5)}for(l.wireframes?a.fillStyle="rgba(255,255,255,0.7)":a.fillStyle="orange",a.fill(),a.beginPath(),r=0;r<t.length;r++)if((o=t[r]).isActive&&(i=o.collision,0<o.activeContacts.length)){var d=o.activeContacts[0].vertex.x,u=o.activeContacts[0].vertex.y;2===o.activeContacts.length&&(d=(o.activeContacts[0].vertex.x+o.activeContacts[1].vertex.x)/2,u=(o.activeContacts[0].vertex.y+o.activeContacts[1].vertex.y)/2),i.bodyB===i.supports[0].body||!0===i.bodyA.isStatic?a.moveTo(d-8*i.normal.x,u-8*i.normal.y):a.moveTo(d+8*i.normal.x,u+8*i.normal.y),a.lineTo(d,u)}l.wireframes?a.strokeStyle="rgba(255,165,0,0.7)":a.strokeStyle="orange",a.lineWidth=1,a.stroke()},b.separations=function(e,t,n){var o,i,r,s,a,l=n,c=e.options;for(l.beginPath(),a=0;a<t.length;a++)if((o=t[a]).isActive){r=(i=o.collision).bodyA;var d=1;(s=i.bodyB).isStatic||r.isStatic||(d=.5),s.isStatic&&(d=0),l.moveTo(s.position.x,s.position.y),l.lineTo(s.position.x-i.penetration.x*d,s.position.y-i.penetration.y*d),d=1,s.isStatic||r.isStatic||(d=.5),r.isStatic&&(d=0),l.moveTo(r.position.x,r.position.y),l.lineTo(r.position.x+i.penetration.x*d,r.position.y+i.penetration.y*d)}c.wireframes?l.strokeStyle="rgba(255,165,0,0.5)":l.strokeStyle="orange",l.stroke()},b.grid=function(e,t,n){var o=n;e.options.wireframes?o.strokeStyle="rgba(255,180,0,0.1)":o.strokeStyle="rgba(255,180,0,0.5)",o.beginPath();for(var i=y.keys(t.buckets),r=0;r<i.length;r++){var s=i[r];if(!(t.buckets[s].length<2)){var a=s.split(/C|R/);o.rect(.5+parseInt(a[1],10)*t.bucketWidth,.5+parseInt(a[2],10)*t.bucketHeight,t.bucketWidth,t.bucketHeight)}}o.lineWidth=1,o.stroke()},b.inspector=function(e,t){e.engine;var n,o=e.selected,i=e.render,r=i.options;if(r.hasBounds){var s=i.bounds.max.x-i.bounds.min.x,a=i.bounds.max.y-i.bounds.min.y,l=s/i.options.width,c=a/i.options.height;t.scale(1/l,1/c),t.translate(-i.bounds.min.x,-i.bounds.min.y)}for(var d=0;d<o.length;d++){var u=o[d].data;switch(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),u.type){case"body":n=u.bounds,t.beginPath(),t.rect(Math.floor(n.min.x-3),Math.floor(n.min.y-3),Math.floor(n.max.x-n.min.x+6),Math.floor(n.max.y-n.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var p=u.pointA;u.bodyA&&(p=u.pointB),t.beginPath(),t.arc(p.x,p.y,10,0,2*Math.PI),t.closePath(),t.stroke()}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",n=e.selectBounds,t.beginPath(),t.rect(Math.floor(n.min.x),Math.floor(n.min.y),Math.floor(n.max.x-n.min.x),Math.floor(n.max.y-n.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),r.hasBounds&&t.setTransform(1,0,0,1,0,0)};var i=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},n},r=function(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},m=function(e,t){var n=e.textures[t];return n||((n=e.textures[t]=new Image).src=t,n)},h=function(e,t){var n=t;/(jpg|gif|png)$/.test(t)&&(n="url("+t+")"),e.canvas.style.background=n,e.canvas.style.backgroundSize="contain",e.currentBackground=t}}()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(e,t,n){var h={};t.exports=h;var b=e("../geometry/Bounds"),w=e("../body/Composite"),m=e("../core/Common"),i=e("../core/Events"),S=e("../geometry/Vector");!function(){var o,t;"undefined"!=typeof window&&(o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(m.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),h.create=function(e){m.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var t={controller:h,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},n=m.extend(t,e),o=!n.options.wireframes&&"transparent"===n.options.background;return n.pixiOptions=n.pixiOptions||{view:n.canvas,transparent:o,antialias:!0,backgroundColor:e.background},n.mouse=e.mouse,n.engine=e.engine,n.renderer=n.renderer||new PIXI.WebGLRenderer(n.options.width,n.options.height,n.pixiOptions),n.container=n.container||new PIXI.Container,n.spriteContainer=n.spriteContainer||new PIXI.Container,n.canvas=n.canvas||n.renderer.view,n.bounds=n.bounds||{min:{x:0,y:0},max:{x:n.options.width,y:n.options.height}},i.on(n.engine,"beforeUpdate",function(){h.clear(n)}),n.textures={},n.sprites={},n.primitives={},n.container.addChild(n.spriteContainer),m.isElement(n.element)?n.element.appendChild(n.canvas):m.warn('No "render.element" passed, "render.canvas" was not inserted into document.'),n.canvas.oncontextmenu=function(){return!1},n.canvas.onselectstart=function(){return!1},n},h.run=function(n){!function e(t){n.frameRequestId=o(e),h.world(n)}()},h.stop=function(e){t(e.frameRequestId)},h.clear=function(e){for(var t=e.container,n=e.spriteContainer;t.children[0];)t.removeChild(t.children[0]);for(;n.children[0];)n.removeChild(n.children[0]);var o=e.sprites["bg-0"];e.textures={},e.sprites={},e.primitives={},(e.sprites["bg-0"]=o)&&t.addChildAt(o,0),e.container.addChild(e.spriteContainer),e.currentBackground=null,t.scale.set(1,1),t.position.set(0,0)},h.setBackground=function(e,t){if(e.currentBackground!==t){var n=t.indexOf&&-1!==t.indexOf("#"),o=e.sprites["bg-0"];if(n){var i=m.colorToNumber(t);e.renderer.backgroundColor=i,o&&e.container.removeChild(o)}else if(!o){var r=s(e,t);(o=e.sprites["bg-0"]=new PIXI.Sprite(r)).position.x=0,o.position.y=0,e.container.addChildAt(o,0)}e.currentBackground=t}},h.world=function(e){var t,n=e.engine.world,o=e.renderer,i=e.container,r=e.options,s=w.allBodies(n),a=w.allConstraints(n),l=[];r.wireframes?h.setBackground(e,r.wireframeBackground):h.setBackground(e,r.background);var c=e.bounds.max.x-e.bounds.min.x,d=e.bounds.max.y-e.bounds.min.y,u=c/e.options.width,p=d/e.options.height;if(r.hasBounds){for(t=0;t<s.length;t++){var m=s[t];m.render.sprite.visible=b.overlaps(m.bounds,e.bounds)}for(t=0;t<a.length;t++){var f=a[t],v=f.bodyA,y=f.bodyB,g=f.pointA,x=f.pointB;v&&(g=S.add(v.position,f.pointA)),y&&(x=S.add(y.position,f.pointB)),g&&x&&((b.contains(e.bounds,g)||b.contains(e.bounds,x))&&l.push(f))}i.scale.set(1/u,1/p),i.position.set(-e.bounds.min.x*(1/u),-e.bounds.min.y*(1/p))}else l=a;for(t=0;t<s.length;t++)h.body(e,s[t]);for(t=0;t<l.length;t++)h.constraint(e,l[t]);o.render(i)},h.constraint=function(e,t){e.engine;var n=t.bodyA,o=t.bodyB,i=t.pointA,r=t.pointB,s=e.container,a=t.render,l="c-"+t.id,c=e.primitives[l];c||(c=e.primitives[l]=new PIXI.Graphics),a.visible&&t.pointA&&t.pointB?(-1===m.indexOf(s.children,c)&&s.addChild(c),c.clear(),c.beginFill(0,0),c.lineStyle(a.lineWidth,m.colorToNumber(a.strokeStyle),1),n?c.moveTo(n.position.x+i.x,n.position.y+i.y):c.moveTo(i.x,i.y),o?c.lineTo(o.position.x+r.x,o.position.y+r.y):c.lineTo(r.x,r.y),c.endFill()):c.clear()},h.body=function(e,t){e.engine;var n=t.render;if(n.visible)if(n.sprite&&n.sprite.texture){var o="b-"+t.id,i=e.sprites[o],r=e.spriteContainer;i||(i=e.sprites[o]=c(e,t)),-1===m.indexOf(r.children,i)&&r.addChild(i),i.position.x=t.position.x,i.position.y=t.position.y,i.rotation=t.angle,i.scale.x=n.sprite.xScale||1,i.scale.y=n.sprite.yScale||1}else{var s="b-"+t.id,a=e.primitives[s],l=e.container;a||((a=e.primitives[s]=d(e,t)).initialAngle=t.angle),-1===m.indexOf(l.children,a)&&l.addChild(a),a.position.x=t.position.x,a.position.y=t.position.y,a.rotation=t.angle-a.initialAngle}};var c=function(e,t){var n=t.render.sprite.texture,o=s(e,n),i=new PIXI.Sprite(o);return i.anchor.x=t.render.sprite.xOffset,i.anchor.y=t.render.sprite.yOffset,i},d=function(e,t){var n,o=t.render,i=e.options,r=new PIXI.Graphics,s=m.colorToNumber(o.fillStyle),a=m.colorToNumber(o.strokeStyle),l=m.colorToNumber(o.strokeStyle),c=m.colorToNumber("#bbb"),d=m.colorToNumber("#CD5C5C");r.clear();for(var u=1<t.parts.length?1:0;u<t.parts.length;u++){n=t.parts[u],i.wireframes?(r.beginFill(0,0),r.lineStyle(1,c,1)):(r.beginFill(s,1),r.lineStyle(o.lineWidth,a,1)),r.moveTo(n.vertices[0].x-t.position.x,n.vertices[0].y-t.position.y);for(var p=1;p<n.vertices.length;p++)r.lineTo(n.vertices[p].x-t.position.x,n.vertices[p].y-t.position.y);r.lineTo(n.vertices[0].x-t.position.x,n.vertices[0].y-t.position.y),r.endFill(),(i.showAngleIndicator||i.showAxes)&&(r.beginFill(0,0),i.wireframes?r.lineStyle(1,d,1):r.lineStyle(1,l),r.moveTo(n.position.x-t.position.x,n.position.y-t.position.y),r.lineTo((n.vertices[0].x+n.vertices[n.vertices.length-1].x)/2-t.position.x,(n.vertices[0].y+n.vertices[n.vertices.length-1].y)/2-t.position.y),r.endFill())}return r},s=function(e,t){var n=e.textures[t];return n||(n=e.textures[t]=PIXI.Texture.fromImage(t)),n}}()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)});